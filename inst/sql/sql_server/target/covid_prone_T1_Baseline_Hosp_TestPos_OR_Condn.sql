CREATE TABLE #Codesets (
  codeset_id int NOT NULL,
  concept_id bigint NOT NULL
)
;

INSERT INTO #Codesets (codeset_id, concept_id)
SELECT 1 as codeset_id, c.concept_id FROM (select distinct I.concept_id FROM
( 
  select concept_id from @vocabulary_database_schema.CONCEPT where concept_id in (37310282)
UNION  select c.concept_id
  from @vocabulary_database_schema.CONCEPT c
  join @vocabulary_database_schema.CONCEPT_ANCESTOR ca on c.concept_id = ca.descendant_concept_id
  and ca.ancestor_concept_id in (37310282)
  and c.invalid_reason is null

) I
) C UNION ALL 
SELECT 2 as codeset_id, c.concept_id FROM (select distinct I.concept_id FROM
( 
  select concept_id from @vocabulary_database_schema.CONCEPT where concept_id in (756055)
UNION  select c.concept_id
  from @vocabulary_database_schema.CONCEPT c
  join @vocabulary_database_schema.CONCEPT_ANCESTOR ca on c.concept_id = ca.descendant_concept_id
  and ca.ancestor_concept_id in (756055)
  and c.invalid_reason is null

) I
LEFT JOIN
(
  select concept_id from @vocabulary_database_schema.CONCEPT where concept_id in (37310281)
UNION  select c.concept_id
  from @vocabulary_database_schema.CONCEPT c
  join @vocabulary_database_schema.CONCEPT_ANCESTOR ca on c.concept_id = ca.descendant_concept_id
  and ca.ancestor_concept_id in (37310281)
  and c.invalid_reason is null

) E ON I.concept_id = E.concept_id
WHERE E.concept_id is null
) C UNION ALL 
SELECT 4 as codeset_id, c.concept_id FROM (select distinct I.concept_id FROM
( 
  select concept_id from @vocabulary_database_schema.CONCEPT where concept_id in (37311061,4100065,439676,37311060)
UNION  select c.concept_id
  from @vocabulary_database_schema.CONCEPT c
  join @vocabulary_database_schema.CONCEPT_ANCESTOR ca on c.concept_id = ca.descendant_concept_id
  and ca.ancestor_concept_id in (37311061,4100065,439676,37311060)
  and c.invalid_reason is null

) I
) C UNION ALL 
SELECT 5 as codeset_id, c.concept_id FROM (select distinct I.concept_id FROM
( 
  select concept_id from @vocabulary_database_schema.CONCEPT where concept_id in (262,9201)
UNION  select c.concept_id
  from @vocabulary_database_schema.CONCEPT c
  join @vocabulary_database_schema.CONCEPT_ANCESTOR ca on c.concept_id = ca.descendant_concept_id
  and ca.ancestor_concept_id in (262,9201)
  and c.invalid_reason is null

) I
) C UNION ALL 
SELECT 11 as codeset_id, c.concept_id FROM (select distinct I.concept_id FROM
( 
  select concept_id from @vocabulary_database_schema.CONCEPT where concept_id in (44802459,3424734,4196006,45615852,3307859,4050473,36309967,3414306,4144987)
UNION  select c.concept_id
  from @vocabulary_database_schema.CONCEPT c
  join @vocabulary_database_schema.CONCEPT_ANCESTOR ca on c.concept_id = ca.descendant_concept_id
  and ca.ancestor_concept_id in (44802459,3424734,4196006,45615852,3307859,4050473,36309967,3414306,4144987)
  and c.invalid_reason is null

) I
LEFT JOIN
(
  select concept_id from @vocabulary_database_schema.CONCEPT where concept_id in (40486534,4208220,4165760,4165758,4165759)
UNION  select c.concept_id
  from @vocabulary_database_schema.CONCEPT c
  join @vocabulary_database_schema.CONCEPT_ANCESTOR ca on c.concept_id = ca.descendant_concept_id
  and ca.ancestor_concept_id in (40486534,4208220,4165760,4165758,4165759)
  and c.invalid_reason is null

) E ON I.concept_id = E.concept_id
WHERE E.concept_id is null
) C UNION ALL 
SELECT 12 as codeset_id, c.concept_id FROM (select distinct I.concept_id FROM
( 
  select concept_id from @vocabulary_database_schema.CONCEPT where concept_id in (4003571,2102976,4231866,2100917,2100898,2101671,2100879,2101678,2100893,2101056,4002559,4024267,2109596,2102978,2102979,2102980,42628022,4340244,2109355,2109357,4138981,4171187,4066654,2782528,2211544,2787924,2787923,43528024,4281936,4340248,4123590,2777423,2776958,2742832,4066974,4068525,42628235,2108916,2211542,4012319,4246302,4304943,42627868,2754378,2754377,2773692,2744409,2754372,2754371,2744379,4213313,4271058,4335368,4048375,4034313,40756933,2773979,2773968,2773969,2773964,2787184,2787185,2787891,2787892,2791227,2211950,40483159,4152081,2103417,2103418,2785440,42628053,42627929,42627866,2774691,2110826,2788762,2785792,4048074,4046290,2787030,2879560,2870872,2839767,2801848,2827338,2796473,2835344,2830226,2834968,2804791,2874204,2856243,2811229,2875196,2888087,2870006,2811376,2856566,2811370,2875212,2851685,2828912,2838844,2803305,2878125,2856577,2828921,2878124,2888096,2851695,2883698,2838851,2823915,2838853,2803315,2798429,2893854,2803316,2851706,2883704,2843708,2851713,2798436,2893867,2870165,1532588,1533549,2851715,2856729,2843718,2798449,1532759,2798453,2816089,2816091,1536012,2811551,2864966,2816245,2896813,2865120,2851880,2803492,2878315,2824103,2829114,1536047,2824105,2865126,2816415,2865382,2824015,2832075,2891509,2852120,2859658,2892182,2798051,2846441,2831618,2798052,2806285,2831770,2851482,2851484,2873195,2846599,2899733,2818630,2851486,2814589,2839331,2852159,2814943,2840251,2847986,2866227,2861335,2804154,2889789,2810247,2863838,2876848,2895328,2895329,2796969,2820751,2820752,2805408,2842769,2838934,2823670,2851609,2837617,2807431,2858052,2825042,2863906,2871739,2833247,2850304,2833925,2876615,2871450,2111282,2787279,2787267,2787291,2787283,2787287,4087575,4034458,4140268,4298562,4323226,4029566,4176615,2003209,2003282,4166295,4141456,2109421,2110729,4341367,46257747,2788039,42897968,4125776,42627983,2787177,2787178,2103553,2103554,4044366,2103560,4326507,2775453,42627935,2109595,2103561,2103573,4195443,4280567,4322336,2111038,4083657,42737025,40757037,4174035,2723950,4170611,4001857)
UNION  select c.concept_id
  from @vocabulary_database_schema.CONCEPT c
  join @vocabulary_database_schema.CONCEPT_ANCESTOR ca on c.concept_id = ca.descendant_concept_id
  and ca.ancestor_concept_id in (4003571,2102976,4231866,2100917,2100898,2101671,2100879,2101678,2100893,2101056,4002559,4024267,2109596,2102978,2102979,2102980,42628022,4340244,2109355,2109357,4138981,4171187,4066654,2782528,2211544,2787924,2787923,43528024,4281936,4340248,4123590,2777423,2776958,2742832,4066974,4068525,42628235,2108916,2211542,4012319,4246302,4304943,42627868,2754378,2754377,2773692,2744409,2754372,2754371,2744379,4213313,4271058,4335368,4048375,4034313,40756933,2773979,2773968,2773969,2773964,2787184,2787185,2787891,2787892,2791227,2211950,40483159,4152081,2103417,2103418,2785440,42628053,42627929,42627866,2774691,2110826,2788762,2785792,4048074,4046290,2787030,2879560,2870872,2839767,2801848,2827338,2796473,2835344,2830226,2834968,2804791,2874204,2856243,2811229,2875196,2888087,2870006,2811376,2856566,2811370,2875212,2851685,2828912,2838844,2803305,2878125,2856577,2828921,2878124,2888096,2851695,2883698,2838851,2823915,2838853,2803315,2798429,2893854,2803316,2851706,2883704,2843708,2851713,2798436,2893867,2870165,1532588,1533549,2851715,2856729,2843718,2798449,1532759,2798453,2816089,2816091,1536012,2811551,2864966,2816245,2896813,2865120,2851880,2803492,2878315,2824103,2829114,1536047,2824105,2865126,2816415,2865382,2824015,2832075,2891509,2852120,2859658,2892182,2798051,2846441,2831618,2798052,2806285,2831770,2851482,2851484,2873195,2846599,2899733,2818630,2851486,2814589,2839331,2852159,2814943,2840251,2847986,2866227,2861335,2804154,2889789,2810247,2863838,2876848,2895328,2895329,2796969,2820751,2820752,2805408,2842769,2838934,2823670,2851609,2837617,2807431,2858052,2825042,2863906,2871739,2833247,2850304,2833925,2876615,2871450,2111282,2787279,2787267,2787291,2787283,2787287,4087575,4034458,4140268,4298562,4323226,4029566,4176615,2003209,2003282,4166295,4141456,2109421,2110729,4341367,46257747,2788039,42897968,4125776,42627983,2787177,2787178,2103553,2103554,4044366,2103560,4326507,2775453,42627935,2109595,2103561,2103573,4195443,4280567,4322336,2111038,4083657,42737025,40757037,4174035,2723950,4170611,4001857)
  and c.invalid_reason is null

) I
) C UNION ALL 
SELECT 13 as codeset_id, c.concept_id FROM (select distinct I.concept_id FROM
( 
  select concept_id from @vocabulary_database_schema.CONCEPT where concept_id in (4039256,4332421,4332236,2754714,2754715,2778274,2778278,2778282,2778276,2778280,2778284,2778275,2778279,2778283,2778277,2778281,2778285,2778262,2778266,2778270,2778264,2778268,2778272,2778263,2778267,2778271,2778265,2778269,2778273,4034460,42872689,4333813,4037820,4040929,3187424,2792184,2792183,2792185,2792187,2792186,2792181,2792180,2792182,4145706,4214028,1531897,1531895,1531892,1532020,1531893,1531882,1531896,1531894,1531887,2722543,2722555,1531888,2722551,2722563,1531878,2722547,2722559,1531883,2722541,2722553,1531890,2722549,2722561,1531880,2722545,2722557,1531885,2722540,2722552,1531891,2722548,2722560,1531881,2722544,2722556,1531886,2722542,2722554,1531889,2722550,2722562,1531879,2722546,2722558,1531884,36685849,4117769,4184589,2795087,4161691,2722569,2722570,4176876,4105130,764450,4142171,2782570,2782569,37397334,2779038,2779039,2779040,2779035,2779036,2779037,4332875,4338013,4034309,4146609,40757086,4033529,2754756,2754757,2760745,2760746,2760747,2760742,2760743,2760744,4177789,2776709,2776701,4126492,2107670,4167421,2754990,2754991,2755255,2755258,2755257,2755256,2755260,2755259,2743636,2722642,2722645,2722648,2722644,2722647,2722650,2743404,2770071,2770074,2770073,2770076,2777220,2736596,2736599,2736602,2736598,2736601,2736604,2779790,2779793,2779796,2779792,2779791,2779795,2779794,2779798,2779797,2761749,2761752,2761755,2761751,2761750,2761754,2761753,2761757,2761756,2722660,2722663,2722666,2722662,2722665,2722668,2743360,2743359,2743641,2770062,2770065,2770064,2770067,2777205,2736587,2736590,2736593,2736589,2736592,2736595,2779781,2779784,2779787,2779783,2779782,2779786,2779785,2779789,2779788,2761740,2761743,2761746,2761742,2761741,2761745,2761744,2761748,2761747,4064001,2782812,4049665,4333693,4333692,4111530,42628060,2755764,2755763,2755766,2755765,2780286,2780280,2780282,2780284,2758496,2758498,2758500,2755777,2780278,2780077,2780079,2780081,2758490,2758492,2758494,4238228,40486402,4207455,2756032,2756033,2722787,2722788,2722789,2759007,2759008,2759009,2722793,2722794,2722795,43014836,43014837,43014838,2759004,2759005,2759006,2756274,2756275,2738875,2759282,2759283,2759284,2759279,2759280,2759281,2738878,4137566,44515128,46271666,2791756,2791753,2723312,2722859,2722860,2723311,2792431,4214423,2783568,2783567,2783569,2783566,40486959,44790030,40486958,4333815,4139773,4219311,4174449,40487005,4328170,4066463,2103417,2103418,4074106,4287414,4335030,4310413,42537164,44783698,4337903,4337874,4200059,4315020,4143310,4146004,42628282,42627894,2781328,2781331,2781334,2781319,2781322,2781325,2756559,2756566,2756556,2756563,2756555,2756562,2781329,2781332,2781335,2781320,2781323,2781326,2781327,2781330,2781333,2781318,2781321,2781324,2756554,2756561,2756553,2756560,2756557,2756564,2756558,2756565,4267121,2777844,2777841,2777842,2777843,2777840,2777837,2777838,2777839,4124889,4119806,2785762,2785755,2785773,2785751,2785742,2785757,2785764,2785753,2785741,2785754,2785744,2785746,2785745,2785748,2785743,2785758,2785752,2785750,2785747,2785761,2785763,2785765,2785759,2785749,2785760,2786504,4309223,4332712,4333816,4334892,4301350,4142163,4312614,2803262,2843839,2836420,4137562,4042524,4039422,709948,709949,4332422,42627954,2617231,4209879,4187965,4311038,2788326,2788327,2788328,2788329,2788330,2788331,2788333,2788334,2788335,2110714,2005909,2783086,4234662,4173628,4145130,42627952,42627953,42628675,42627936,37395327,4040570,4042488,4040536,4124879,4281230,40487127,42628617,2760153,2778067,2759556,2759557,2778066,2759554,2759555,4302694,2760182,2757322,2757320,2757321,2760016,2760013,2760014,2760015,2760012,2760009,2760010,2760011,2109594,4074102,2779112,2779091,2779098,2779105,2779084,2779629,2779636,2779077,2783867,2783866,2783865,2779109,2779088,2779095,2779102,2723558,2723543,2723548,2723553,2779081,2779626,2779633,2779074,2779111,2779090,2779097,2779104,2723560,2723545,2723550,2723555,2779083,2779628,2779635,2779076,2783870,2723559,2723544,2723549,2723554,2723561,2723547,2723552,2723557,2779114,2779093,2779100,2779107,2779086,2779631,2779638,2779079,2779115,2779094,2779101,2779108,43014831,43014832,43014833,2779087,2779632,2779639,2779080,2783871,2783868,2783869,2779110,2779089,2779096,2779103,2779082,2779627,2779634,2779075,2783864,2779113,2779092,2779099,2779106,2723546,2723551,2723556,2779085,2779630,2779637,2779078,2783863,4236908,3174537,4266591,4062093,4145060,4332711,4216602,2754035,2754036,2784596,2784400,2784594,2784595,2760525,2760526,2760527,2752599,2784399,2784396,2784397,2784398,2760522,2760523,2760524,4288752,4242722,2754289,2754292,2754291,2754294,2754290,2754293,2760785,2760786,2723256,2723257,2723258,2760783,2760784,2761029,2761030,2761027,2761028,2782372,2782370,3173331,42366067,4124874,4335469,4281528,709975,4168207,4145200,4143766,4184922,2784849,2784852,2784851,2784854,2784850,2784853,2761512,2761515,2761514,2761517,2761513,2761516,2784654,2784657,2784656,2784848,2784655,2784847,2761314,2761317,2761316,2761511,2761315,2761510,2754806,2754809,2754808,2754811,2754807,2754810,42689528,4099228,2796226,2794318,2796761,2796752,2796603,2794077,2794267,2794264,2794131,2794269,2794104,2794103,2794294,2794293,2794300,2795831,2796041,2796036,2796033,2796040,2796010,2796200,2796204,2796400,2796403,2796395,2796387,2796394,2788807,2314294,2314287,2314285,2314284,2788412,2788221,2755826,2755829,2755827,2755830,2755828,2755831,2758063,2758064,2758061,2758062,4073819,4190421,4198776,46272874,4126479,2103581,2314289,2211550,2211554,2794484,2794497,2794495,2794494,2794492,2794491,2794485,2794508,2794502,2794657,2794658,2794661,2794654,2794651,2794518,2794653,2794517,2794670)
UNION  select c.concept_id
  from @vocabulary_database_schema.CONCEPT c
  join @vocabulary_database_schema.CONCEPT_ANCESTOR ca on c.concept_id = ca.descendant_concept_id
  and ca.ancestor_concept_id in (4039256,4332421,4332236,2754714,2754715,2778274,2778278,2778282,2778276,2778280,2778284,2778275,2778279,2778283,2778277,2778281,2778285,2778262,2778266,2778270,2778264,2778268,2778272,2778263,2778267,2778271,2778265,2778269,2778273,4034460,42872689,4333813,4037820,4040929,3187424,2792184,2792183,2792185,2792187,2792186,2792181,2792180,2792182,4145706,4214028,1531897,1531895,1531892,1532020,1531893,1531882,1531896,1531894,1531887,2722543,2722555,1531888,2722551,2722563,1531878,2722547,2722559,1531883,2722541,2722553,1531890,2722549,2722561,1531880,2722545,2722557,1531885,2722540,2722552,1531891,2722548,2722560,1531881,2722544,2722556,1531886,2722542,2722554,1531889,2722550,2722562,1531879,2722546,2722558,1531884,36685849,4117769,4184589,2795087,4161691,2722569,2722570,4176876,4105130,764450,4142171,2782570,2782569,37397334,2779038,2779039,2779040,2779035,2779036,2779037,4332875,4338013,4034309,4146609,40757086,4033529,2754756,2754757,2760745,2760746,2760747,2760742,2760743,2760744,4177789,2776709,2776701,4126492,2107670,4167421,2754990,2754991,2755255,2755258,2755257,2755256,2755260,2755259,2743636,2722642,2722645,2722648,2722644,2722647,2722650,2743404,2770071,2770074,2770073,2770076,2777220,2736596,2736599,2736602,2736598,2736601,2736604,2779790,2779793,2779796,2779792,2779791,2779795,2779794,2779798,2779797,2761749,2761752,2761755,2761751,2761750,2761754,2761753,2761757,2761756,2722660,2722663,2722666,2722662,2722665,2722668,2743360,2743359,2743641,2770062,2770065,2770064,2770067,2777205,2736587,2736590,2736593,2736589,2736592,2736595,2779781,2779784,2779787,2779783,2779782,2779786,2779785,2779789,2779788,2761740,2761743,2761746,2761742,2761741,2761745,2761744,2761748,2761747,4064001,2782812,4049665,4333693,4333692,4111530,42628060,2755764,2755763,2755766,2755765,2780286,2780280,2780282,2780284,2758496,2758498,2758500,2755777,2780278,2780077,2780079,2780081,2758490,2758492,2758494,4238228,40486402,4207455,2756032,2756033,2722787,2722788,2722789,2759007,2759008,2759009,2722793,2722794,2722795,43014836,43014837,43014838,2759004,2759005,2759006,2756274,2756275,2738875,2759282,2759283,2759284,2759279,2759280,2759281,2738878,4137566,44515128,46271666,2791756,2791753,2723312,2722859,2722860,2723311,2792431,4214423,2783568,2783567,2783569,2783566,40486959,44790030,40486958,4333815,4139773,4219311,4174449,40487005,4328170,4066463,2103417,2103418,4074106,4287414,4335030,4310413,42537164,44783698,4337903,4337874,4200059,4315020,4143310,4146004,42628282,42627894,2781328,2781331,2781334,2781319,2781322,2781325,2756559,2756566,2756556,2756563,2756555,2756562,2781329,2781332,2781335,2781320,2781323,2781326,2781327,2781330,2781333,2781318,2781321,2781324,2756554,2756561,2756553,2756560,2756557,2756564,2756558,2756565,4267121,2777844,2777841,2777842,2777843,2777840,2777837,2777838,2777839,4124889,4119806,2785762,2785755,2785773,2785751,2785742,2785757,2785764,2785753,2785741,2785754,2785744,2785746,2785745,2785748,2785743,2785758,2785752,2785750,2785747,2785761,2785763,2785765,2785759,2785749,2785760,2786504,4309223,4332712,4333816,4334892,4301350,4142163,4312614,2803262,2843839,2836420,4137562,4042524,4039422,709948,709949,4332422,42627954,2617231,4209879,4187965,4311038,2788326,2788327,2788328,2788329,2788330,2788331,2788333,2788334,2788335,2110714,2005909,2783086,4234662,4173628,4145130,42627952,42627953,42628675,42627936,37395327,4040570,4042488,4040536,4124879,4281230,40487127,42628617,2760153,2778067,2759556,2759557,2778066,2759554,2759555,4302694,2760182,2757322,2757320,2757321,2760016,2760013,2760014,2760015,2760012,2760009,2760010,2760011,2109594,4074102,2779112,2779091,2779098,2779105,2779084,2779629,2779636,2779077,2783867,2783866,2783865,2779109,2779088,2779095,2779102,2723558,2723543,2723548,2723553,2779081,2779626,2779633,2779074,2779111,2779090,2779097,2779104,2723560,2723545,2723550,2723555,2779083,2779628,2779635,2779076,2783870,2723559,2723544,2723549,2723554,2723561,2723547,2723552,2723557,2779114,2779093,2779100,2779107,2779086,2779631,2779638,2779079,2779115,2779094,2779101,2779108,43014831,43014832,43014833,2779087,2779632,2779639,2779080,2783871,2783868,2783869,2779110,2779089,2779096,2779103,2779082,2779627,2779634,2779075,2783864,2779113,2779092,2779099,2779106,2723546,2723551,2723556,2779085,2779630,2779637,2779078,2783863,4236908,3174537,4266591,4062093,4145060,4332711,4216602,2754035,2754036,2784596,2784400,2784594,2784595,2760525,2760526,2760527,2752599,2784399,2784396,2784397,2784398,2760522,2760523,2760524,4288752,4242722,2754289,2754292,2754291,2754294,2754290,2754293,2760785,2760786,2723256,2723257,2723258,2760783,2760784,2761029,2761030,2761027,2761028,2782372,2782370,3173331,42366067,4124874,4335469,4281528,709975,4168207,4145200,4143766,4184922,2784849,2784852,2784851,2784854,2784850,2784853,2761512,2761515,2761514,2761517,2761513,2761516,2784654,2784657,2784656,2784848,2784655,2784847,2761314,2761317,2761316,2761511,2761315,2761510,2754806,2754809,2754808,2754811,2754807,2754810,42689528,4099228,2796226,2794318,2796761,2796752,2796603,2794077,2794267,2794264,2794131,2794269,2794104,2794103,2794294,2794293,2794300,2795831,2796041,2796036,2796033,2796040,2796010,2796200,2796204,2796400,2796403,2796395,2796387,2796394,2788807,2314294,2314287,2314285,2314284,2788412,2788221,2755826,2755829,2755827,2755830,2755828,2755831,2758063,2758064,2758061,2758062,4073819,4190421,4198776,46272874,4126479,2103581,2314289,2211550,2211554,2794484,2794497,2794495,2794494,2794492,2794491,2794485,2794508,2794502,2794657,2794658,2794661,2794654,2794651,2794518,2794653,2794517,2794670)
  and c.invalid_reason is null

) I
) C UNION ALL 
SELECT 14 as codeset_id, c.concept_id FROM (select distinct I.concept_id FROM
( 
  select concept_id from @vocabulary_database_schema.CONCEPT where concept_id in (4128883,4125322,4144850,4266834,4226702,4021529,40486551,4200678,4200677,4027862,4136758,42537607,4148975,2108486,44510826,4336541,4144721,42572937,40479234,2721110,4137462,4218442,4031359,4035031,4300370,2109915,4067693,4272237,4340098,4146631,4146030,4141110,4103760,4146035,4290511,4068760,4050432,4146028,4028264,4069356,4139935,4230825,4127127,4165050,4134888,2003225,4240962,4337833,4139993,4096612,4017325,4128868,4201947,4168602,4080446,4134277,4123566,4013040,4033545,4231866,4161827,4069845,4193311,4201274,4196081,4314572,4123892,4123393,4141257,4144202,4267594,4341882,2109387,2109388,2109385,2109386,4343005,2100701,4198094,4307525,4265338,4220681,4267446,4187087,4052107,4159951,4050715,4052110,4049544,4231828,4050714,4050132,4225291,4050131,44512700,4122778,4123392,4125436,4166855,4068996,40488424,40490977,4197729,4233085,4207467,2002489,2002487,2002485,2002486,4194743,4049675,4052252,927191,4177489,4226017,4231680,4231681,4226966,4227085,4236711,4324125,4226959,4231682,4226960,4226016,4226015,4247783,4246870,4099918,4313138,4071882,4187945,4198190,2109141,38001162,4174214,2109143,2109142,4172277,4236706,4294254,4066293,4321450,4264003,2104947,2104948,709764,709966,709965,44789819,44789822,44789820,4107100,2108484,2108483,4303853,4152317,4149509,4021728,4119652,4049677,4226808,4234803,4231417,4226811,2109584,2109423,2109326,2109328,2109327,4226439,4170280,4019925,4198349,4245040,4114630,4065443,4320461,2006434,43021873,3175919,3181576,4244124,4297990,43021519,3186140,2006432,4297155,4294395,4174346,4107080,2110268,2110269,2110270,3189851,4195462,4120071,4120073,4095787,4144927,4125151,4123752,4123258,4128704,4123754,4123753,4067713,2108469,4276584,4123397,4075296,4071494,4075297,4125465,4227245,4216472,44809456,44809457,2102759,4264332,4032640,2102758,4216471,4064295,2102773,2102761,4179352,4054237,4023415,4286951,2729935,2730221,2733407,2730201,2729975,2730448,2729955,2730428,2730181,2730468,2729943,2730416,2729923,2730209,2730169,2730456,2729963,2730436,2730189,2730476,2729949,2730422,2729929,2730215,2730175,2730462,2729969,2730442,2730195,2730668,2729952,2730425,2729932,2730218,2730178,2730465,2729972,2730445,2730198,2730671,2729946,2730419,2729926,2730212,2730172,2730459,2729966,2730439,2730192,2730665,2729940,2730226,2729920,2730206,2730166,2730453,2729960,2730433,2730186,2730473,2729936,2730222,2733408,2730202,2729976,2730449,2729956,2730429,2730182,2730469,2729942,2730415,2729922,2730208,2730168,2730455,2729962,2730435,2730188,2730475,2729948,2730421,2729928,2730214,2730174,2730461,2729968,2730441,2730194,2730667,2729951,2730424,2729931,2730217,2730177,2730464,2729971,2730444,2730197,2730670,2729945,2730418,2729925,2730211,2730171,2730458,2729965,2730438,2730191,2730664,2729939,2730225,2729919,2730205,2730165,2730452,2729959,2730432,2730185,2730472,2729954,2730427,2729934,2730220,2730180,2730467,2729974,2730447,2730200,2730673,2729953,2730426,2729933,2730219,2730179,2730466,2729973,2730446,2730199,2730672,2729937,2730223,2733409,2730203,2729977,2730450,2729957,2730430,2730183,2730470,2729941,2730414,2729921,2730207,2730167,2730454,2729961,2730434,2730187,2730474,2729947,2730420,2729927,2730213,2730173,2730460,2729967,2730440,2730193,2730666,2729950,2730423,2729930,2730216,2730176,2730463,2729970,2730443,2730196,2730669,2729944,2730417,2729924,2730210,2730170,2730457,2729964,2730437,2730190,2730663,2729938,2730224,2729918,2730204,2730164,2730451,2729958,2730431,2730184,2730471,2753489,2753492,2753491,2753494,2753490,2753493,2746692,2746717,2746741,2746704,2746729,2746951,2746698,2746723,2746945,2746710,2746735,2746957,2746691,2746716,2746740,2746703,2746728,2746950,2746697,2746715,2746722,2746944,2746709,2746734,2746956,2746694,2746719,2746941,2746706,2746731,2746953,2746700,2746725,2746947,2746712,2746737,2746959,2746696,2746721,2746943,2746708,2746733,2746955,2746702,2746727,2746949,2746714,2746739,2746961,2746695,2746720,2746942,2746707,2746732,2746954,2746701,2746726,2746948,2746713,2746738,2746960,2746693,2746718,2746742,2746705,2746730,2746952,2746699,2746724,2746946,2746711,2746736,2746958,2776155,2776188,2776171,2776204,2776163,2776196,2776179,2776405,2776153,2776169,2776161,2776177,2776152,2776185,2776168,2776201,2776160,2776193,2776176,2776402,2776157,2776173,2776165,2776182,2776181,2776156,2776172,2776164,2776180,2776154,2776170,2776162,2776178,2776151,2776167,2776159,2776175,2776150,2776166,2776158,2776174,2776421,2776427,2776424,2776430,2776423,2776429,2776420,2776426,2776432,2776422,2776428,2776425,2776431,2746216,2746438,2746466,2746423,2746452,2746679,2746416,2746445,2746473,2746430,2746459,2746686,2746218,2746440,2746468,2746425,2746454,2746681,2746418,2746447,2746475,2746432,2746461,2746688,2746220,2746442,2746470,2746427,2746456,2746683,2746420,2746449,2746477,2746434,2746463,2746690,2746219,2746441,2746469,2746426,2746455,2746682,2746419,2746448,2746476,2746433,2746462,2746689,2746217,2746439,2746467,2746424,2746453,2746680,2746417,2746446,2746474,2746431,2746460,2746687,2722485,2722515,43014805,2722505,2722535,43014825,2722495,2722525,43014815,2753449,2753465,2753457,2753473,2753451,2753467,2753459,2753475,2753450,2753466,2753458,2753474,2753445,2753453,2753448,2753464,2753456,2753472,2753447,2753463,2753455,2753471,2753452,2753468,2753460,2753476,2753446,2753454,43016941,43016957,43016949,43016965,43016943,43016959,43016951,43016967,43016942,43016958,43016950,43016966,43016937,43016945,43016940,43016956,43016948,43016964,43016939,43016955,43016947,43016963,43016944,43016960,43016952,43016968,43016938,43016946,2753222,2753238,2753230,2753441,2753224,2753435,2753232,2753443,2753223,2753239,2753231,2753442,2753218,2753226,2753221,2753237,2753229,2753440,2753220,2753236,2753228,2753439,2753225,2753436,2753233,2753444,2753219,2753227,2747215,2747232,2747248,2747223,2747240,2747256,2747219,2747231,2747236,2747252,2747227,2747244,2747460,2747216,2747233,2747249,2747224,2747241,2747257,2747220,2747237,2747253,2747228,2747245,2747461,2747218,2747235,2747251,2747226,2747243,2747459,2747222,2747239,2747255,2747230,2747247,2747463,2747217,2747234,2747250,2747225,2747242,2747458,2747221,2747238,2747254,2747229,2747246,2747462,2749222,2749232,2749227,2749242,2749237,2749223,2749233,2749228,2749238,2749225,2749235,2749230,2749240,2749224,2749234,2749229,2749239,2749226,2749236,2749231,2749241,2748710,2748720,2748715,2748725,2748712,2748722,2748717,2748727,2748711,2748721,2748716,2748726,2748709,2748947,2748719,2748957,2748714,2748952,2748724,2748962,2752925,2752941,2752933,2752949,2752927,2752943,2752935,2752951,2752926,2752942,2752934,2752950,2752921,2752929,2752924,2752940,2752932,2752948,2752923,2752939,2752931,2752947,2752928,2752944,2752936,2752952,2752922,2752930,43015512,43015527,43015509,43015524,43015518,43015533,43015515,43015530,43015521,43015536,43015511,43015526,43015508,43015523,43015517,43015532,43015514,43015529,43015520,43015535,43015510,43015525,43015507,43015522,43015516,43015531,43015513,43015528,43015519,43015534,2745923,2745941,2745932,2745950,2745918,2745936,2745927,2745945,2745917,2745935,2745926,2745944,2745915,2745933,2745924,2745951,2745942,2745920,2745938,2745929,2745947,2745916,2745934,2745925,2745943,2745922,2745940,2745931,2745949,2745921,2745939,2745930,2745948,2745919,2745937,2745928,2745946,43016261,43016255,43016258,43016267,43016264,43016270,43016259,43016253,43016256,43016265,43016262,43016268,43016260,43016254,43016257,43016266,43016263,43016269,2727307,2727329,2727313,2726923,2727345,2726939,2727304,2727326,2727310,2726920,2727342,2726936,2727317,2727306,2727328,2727312,2726922,2727344,2726938,2727303,2727325,2727309,2726919,2727341,2726935,2727331,2727315,2726925,2727347,2726941,2727316,2727305,2727327,2727311,2726921,2727343,2726937,2727302,2727324,2727308,2726918,2727340,2726934,2727330,2727314,2726924,2727346,2726940,2727617,2749490,2749510,2749500,2749520,2749485,2749505,2749495,2749515,2749484,2749504,2749494,2749514,2749481,2749501,2749491,2749521,2749511,2749487,2749507,2749497,2749517,2749483,2749503,2749493,2749513,2749482,2749502,2749492,2749512,2749489,2749509,2749499,2749519,2749488,2749508,2749498,2749518,2749486,2749506,2749496,2749516,1531933,1531931,1531929,1531932,1531930,1531928,1531861,1531855,1531853,1531854,1531852,2727352,2727836,2727384,2727368,2727400,2727358,2727842,2727390,2727374,2727406,2727849,2727833,2727381,2727365,2727397,2727355,2727839,2727387,2727371,2727403,2727362,2727846,2727394,2727378,2727410,2727351,2727835,2727383,2727367,2727399,2727357,2727841,2727389,2727373,2727405,2727848,2727832,2727380,2727364,2727396,2727354,2727838,2727386,2727370,2727402,2727360,2727844,2727392,2727376,2727408,2727361,2727845,2727393,2727377,2727409,2727350,2727834,2727382,2727366,2727398,2727356,2727840,2727388,2727372,2727404,2727847,2727831,2727379,2727363,2727395,2727353,2727837,2727385,2727369,2727401,43015543,43015542,43015545,43015544,43015546,2727359,2727843,2727391,2727375,2727407,2727436,2727432,2727444,2727440,2727448,2727435,2727431,2727443,2727439,2727447,2727438,2727434,2727446,2727442,2727450,43015553,43015552,43015555,43015554,43015556,2727437,2727433,2727445,2727441,2727449,2727634,2727632,2727638,2727636,2727640,2727635,2727633,2727639,2727637,2727641,43015563,43015562,43015565,43015564,43015566,1531845,1531846,1531843,1531844,1531842,2731671,2731958,2731466,2731938,2731711,2732186,2731691,2732166,2731918,2732206,2731679,2731966,2731659,2731946,2731719,2732194,2731699,2732174,2731926,2732214,2731685,2732160,2731665,2731952,2731912,2732200,2731705,2732180,2731932,2732409,2731688,2732163,2731668,2731955,2731915,2732203,2731708,2732183,2731935,2732412,2731682,2732157,2731662,2731949,2731909,2732197,2731702,2732177,2731929,2732406,2731676,2731963,2731471,2731943,2731716,2732191,2731696,2732171,2731923,2732211,2731672,2731959,2731467,2731939,2731712,2732187,2731692,2732167,2731919,2732207,2731678,2731965,2731658,2731945,2731718,2732193,2731698,2732173,2731925,2732213,2731684,2732159,2731664,2731951,2731911,2732199,2731704,2732179,2731931,2732408,2731687,2732162,2731667,2731954,2731914,2732202,2731707,2732182,2731934,2732411,2731681,2731968,2731661,2731948,2731908,2732196,2731701,2732176,2731928,2732216,2731675,2731962,2731470,2731942,2731715,2732190,2731695,2732170,2731922,2732210,2731690,2732165,2731670,2731957,2731917,2732205,2731710,2732185,2731937,2732414,2731689,2732164,2731669,2731956,2731916,2732204,2731709,2732184,2731936,2732413,2731673,2731960,2731468,2731940,2731713,2732188,2731693,2732168,2731920,2732208,2731677,2731964,2731472,2731944,2731717,2732192,2731697,2732172,2731924,2732212,2731683,2732158,2731663,2731950,2731910,2732198,2731703,2732178,2731930,2732407,2731686,2732161,2731666,2731953,2731913,2732201,2731706,2732181,2731933,2732410,2731680,2731967,2731660,2731947,2731720,2732195,2731700,2732175,2731927,2732215,2731674,2731961,2731469,2731941,2731714,2732189,2731694,2732169,2731921,2732209,2727658,2727657,2727660,2727659,2727661,43015583,43015582,43015585,43015584,43015586,2729763,2730005,2729777,2730019,2729766,2730008,2729986,2730229,2729788,2730030,2729997,2730240,2729760,2730002,2729778,2730020,2729767,2730009,2729987,2730230,2729789,2730031,2729998,2730241,2729762,2730004,2729776,2730018,2729765,2730007,2729985,2730228,2729787,2730029,2729996,2730239,2729759,2730001,2729779,2730021,2729768,2730010,2729988,2730231,2729790,2730032,2729999,2730242,2729761,2730003,2729775,2730017,2729764,2730006,2729984,2730227,2729786,2730028,2729995,2730238,2729758,2730000,2730531,2730763,2730522,2730754,2730736,2730781,2730727,2730772,2730745,2730977,2730535,2730767,2730526,2730758,2730740,2730785,2730731,2730776,2730749,2730981,2730530,2730762,2730521,2730753,2730735,2730780,2730726,2730771,2730744,2730976,2730536,2730768,2730527,2730759,2730741,2730786,2730732,1531945,2730777,2730750,2730982,2730537,2730769,2730528,2730760,2730742,2730787,2730733,1531944,2730778,2730751,2730983,2730533,2730765,2730524,2730756,2730738,2730783,2730729,2730774,2730747,2730979,2730532,2730764,2730523,2730755,2730737,2730782,2730728,2730773,2730746,2730978,2730534,2730766,2730525,2730757,2730739,2730784,2730730,2730775,2730748,2730980,2730529,2730761,2730520,2730752,2730734,2730779,2730538,2730770,2730743,2730788,43015480,43015495,43015477,43015492,43015486,43015501,43015483,43015498,43015489,43015504,43015481,43015496,43015478,43015493,43015487,43015502,43015484,1531909,43015499,43015490,43015505,43015482,43015497,43015479,43015494,43015488,43015503,43015485,1531908,43015500,43015491,43015506,2753190,2753206,2753198,2753214,2753192,2753208,2753200,2753216,2753191,2753207,2753199,2753215,2753186,2753194,2753189,2753205,2753197,2753213,2753188,2753204,2753196,2753212,2753193,2753209,2753201,2753217,2753187,2753195,2727648,2727647,2727650,2727649,2727651,43015573,43015572,43015575,43015574,43015576,2732908,2732963,2732922,2733166,2732911,2732966,2732944,2733188,2732933,2733177,2732955,2733199,2732716,2732960,2732923,2733167,2732912,2732967,2732945,2733189,2732934,2733178,2732956,2733200,2732718,2732962,2732921,2733165,2732910,2732965,2732943,2733187,2732932,2733176,2732954,2733198,2732715,2732959,2732924,2733168,2732913,2732968,2732946,2733190,2732935,2733179,2732957,2733201,2732717,2732961,2732920,2733164,2732909,2732964,2732942,2733186,2732931,2733175,2732953,2733197,2732714,2732958,2775181,2775417,2775396,2775437,2775191,2775427,2775406,2775447,2775178,2775414,2775393,2775434,2775188,2775424,2775403,2775444,2775180,2775395,2775190,2775405,2775177,2775413,2775392,2775433,2775187,2775423,2775402,2775443,2775176,2775412,2775391,2775432,2775186,2775422,2775401,2775442,43015420,43015435,43015417,43015432,43015426,43015441,43015423,43015438,43015429,43015444,43015421,43015436,43015418,43015433,43015427,43015442,43015424,1531913,43015439,43015430,43015445,43015422,43015437,43015419,43015434,43015428,43015443,43015425,1531912,43015440,43015431,43015446,2731225,2731250,2731036,2731245,2731235,2731260,2731230,2731255,2731240,2731265,2731226,2731251,2731037,2731246,2731236,2731261,2731231,1531941,2731256,2731241,2731266,2731227,2731252,2731038,2731247,2731237,2731262,2731232,1531940,2731257,2731242,2731267,2731224,2731249,2731035,2731244,2731234,2731259,2731229,2731254,2731239,2731264,2731223,2731248,2731034,2731243,2731233,2731258,2731228,2731253,2731238,2731263,1531921,1531919,1531917,1531920,1531918,1531916,42894378,42894375,42894493,42894490,42894487,42894372,42894373,42894377,42894374,42894492,42894489,42894486,42894371,2727607,2727610,2727608,2727614,2727612,2727616,2727057,2727039,2727093,2727075,2727738,2727063,2727045,2727726,2727081,2727744,2727054,2727036,2727090,2727072,2727735,2727060,2727042,2727096,2727078,2727741,2727067,2727049,2727730,2727085,2727748,2727056,2727038,2727092,2727074,2727737,2727062,2727044,2727098,2727080,2727743,2727051,2727732,2727053,2727035,2727089,2727071,2727734,2727059,2727041,2727095,2727077,2727740,2727065,2727047,2727728,2727083,2727746,2727066,2727048,2727729,2727084,2727747,2727055,2727037,2727091,2727073,2727736,2727061,2727043,2727097,2727079,2727742,2727050,2727731,2727052,2727034,2727088,2727070,2727733,2727058,2727040,2727094,2727076,2727739,2727064,2727046,2727727,2727082,2727745,2727667,2727461,2727464,2727462,2727468,2727466,2727470,2775902,2775935,2775918,2775951,2775910,2775943,2775926,2776147,2775900,2775916,2775908,2775924,2775899,2775932,2775915,2775948,2775907,2775940,2775923,2776144,2775904,2775920,2775912,2775929,2775928,2775903,2775919,2775911,2775927,2775901,2775917,2775909,2775925,2775898,2775914,2775906,2775922,2775897,2775913,2775905,2775921,2748455,2748465,2748460,2748470,2748457,2748467,2748462,2748472,2748456,2748466,2748461,2748471,2748454,2748689,2748464,2748699,2748459,2748694,2748469,2748704,2748199,2748209,2748204,2748214,2748201,2748211,2748206,2748216,2748200,2748210,2748205,2748215,2748198,2748434,2748208,2748444,2748203,2748439,2748213,2748449,2753694,2753697,2753696,2753699,2753695,2753698,2753477,2753480,2753479,2753482,2753478,2753481,42894306,42894303,42894315,42894312,42894309,42894300,42894301,42894305,42894302,42894314,42894311,42894308,42894299,1531939,1531937,1531935,1531938,1531936,1531934,1531859,1531860,1531857,1531858,1531856,2727772,2727756,2727804,2727788,2727820,2727778,2727762,2727810,2727794,2727826,2727769,2727753,2727801,2727785,2727817,2727775,2727759,2727807,2727791,2727823,2727782,2727766,2727814,2727798,2727830,2727771,2727755,2727803,2727787,2727819,2727777,2727761,2727809,2727793,2727825,2727768,2727752,2727800,2727784,2727816,2727774,2727758,2727806,2727790,2727822,2727780,2727764,2727812,2727796,2727828,2727781,2727765,2727813,2727797,2727829,2727770,2727754,2727802,2727786,2727818,2727776,2727760,2727808,2727792,2727824,2727767,2727751,2727799,2727783,2727815,2727773,2727757,2727805,2727789,2727821,43015538,43015537,43015540,43015539,43015541,2727779,2727763,2727811,2727795,2727827,2727418,2727414,2727426,2727422,2727430,2727416,2727412,2727424,2727420,2727428,2727415,2727411,2727423,2727419,2727427,43015548,43015547,43015550,43015549,43015551,2727417,2727413,2727425,2727421,2727429,2727624,2727622,2727628,2727626,2727630,43015558,43015557,43015560,43015559,43015561,2727625,2727623,2727629,2727627,2727631,1531850,1531851,1531848,1531849,1531847,2730724,2731197,2730704,2731177,2730951,2731426,2730931,2731217,2730971,2731446,2730919,2731205,2730712,2731185,2730959,2731434,2730939,2731414,2731165,2731454,2730925,2731211,2730718,2731191,2730965,2731440,2730945,2731420,2731171,2731460,2730928,2731214,2730721,2731194,2730968,2731443,2730948,2731423,2731174,2731463,2730922,2731208,2730715,2731188,2730962,2731437,2730942,2731417,2731168,2731457,2730916,2731202,2730709,2731182,2730956,2731431,2730936,2731222,2731162,2731451,2730725,2731198,2730705,2731178,2730952,2731427,2730932,2731218,2730972,2731447,2730918,2731204,2730711,2731184,2730958,2731433,2730938,2731413,2731164,2731453,2730924,2731210,2730717,2731190,2730964,2731439,2730944,2731419,2731170,2731459,2730927,2731213,2730720,2731193,2730967,2731442,2730947,2731422,2731173,2731462,2730921,2731207,2730714,2731187,2730961,2731436,2730941,2731416,2731167,2731456,2730915,2731201,2730708,2731181,2730955,2731430,2730935,2731221,2730975,2731450,2730930,2731216,2730723,2731196,2730970,2731445,2730950,2731425,2731176,2731465,2730929,2731215,2730722,2731195,2730969,2731444,2730949,2731424,2731175,2731464,2730913,2731199,2730706,2731179,2730953,2731428,2730933,2731219,2730973,2731448,2730917,2731203,2730710,2731183,2730957,2731432,2730937,2731412,2731163,2731452,2730923,2731209,2730716,2731189,2730963,2731438,2730943,2731418,2731169,2731458,2730926,2731212,2730719,2731192,2730966,2731441,2730946,2731421,2731172,2731461,2730920,2731206,2730713,2731186,2730960,2731435,2730940,2731415,2731166,2731455,2730914,2731200,2730707,2731180,2730954,2731429,2730934,2731220,2730974,2731449,43015578,43015577,43015580,43015579,43015581,2727653,2727652,2727655,2727654,2727656,2733207,2733451,2733410,2733465,2733210,2733454,2733432,2729744,2733421,2729733,2733443,2729755,2733204,2733448,2733411,2733466,2733211,2733455,2733433,2729745,2733422,2729734,2733444,2729756,2733206,2733450,2733220,2733464,2733209,2733453,2733431,2729743,2733420,2729732,2733442,2729754,2733203,2733447,2733412,2733467,2733212,2733456,2733434,2729746,2733423,2729735,2733445,2729757,2733205,2733449,2733219,2733463,2733208,2733452,2733430,2729742,2733419,2729731,2733441,2729753,2733202,2733446,2730254,2730486,2730245,2730477,2730272,2730504,2730263,2730495,2730281,2730513,2730258,2730490,2730249,2730481,2730276,2730508,2730267,2730499,2730285,2730517,2730253,2730485,2730244,2730289,2730271,2730503,2730262,2730494,2730280,2730512,2730259,2730491,2730250,2730482,2730277,2730509,2730268,1531947,2730500,2730286,2730518,2730260,2730492,2730251,2730483,2730278,2730510,2730269,1531946,2730501,2730287,2730519,2730256,2730488,2730247,2730479,2730274,2730506,2730265,2730497,2730283,2730515,2730255,2730487,2730246,2730478,2730273,2730505,2730264,2730496,2730282,2730514,2730257,2730489,2730248,2730480,2730275,2730507,2730266,2730498,2730284,2730516,2730252,2730484,2730243,2730288,2730270,2730502,2730261,2730493,2730279,2730511,43015450,43015465,43015447,43015462,43015456,43015471,43015453,43015468,43015459,43015474,43015451,43015466,43015448,43015463,43015457,43015472,43015454,1531911,43015469,43015460,43015475,43015452,43015467,43015449,43015464,43015458,43015473,43015455,1531910,43015470,43015461,43015476,2752957,2752973,2752965,2753182,2752959,2752975,2752967,2753184,2752958,2752974,2752966,2753183,2752953,2752961,2752956,2752972,2752964,2753181,2752955,2752971,2752963,2753180,2752960,2752976,2752968,2753185,2752954,2752962,43015568,43015567,43015570,43015569,43015571,2727643,2727642,2727645,2727644,2727646,2732420,2732664,2732434,2732678,2732423,2732667,2732456,2732700,2732445,2732689,2732467,2732711,2732417,2732661,2732435,2732679,2732424,2732668,2732457,2732701,2732446,2732690,2732468,2732712,2732419,2732663,2732433,2732677,2732422,2732666,2732455,2732699,2732444,2732688,2732466,2732710,2732416,2732660,2732436,2732680,2732425,2732669,2732458,2732702,2732447,2732691,2732658,2732713,2732418,2732662,2732432,2732676,2732421,2732665,2732454,2732698,2732443,2732687,2732465,2732709,2732415,2732659,2774908,2775141,2774928,2775161,2774918,2775151,2774938,2775171,2774905,2775138,2774925,2775158,2774915,2775148,2774935,2775168,2774907,2774927,2774917,2774937,2774904,2775137,2774924,2775157,2774914,2775147,2774934,2775167,2774903,2775136,2774923,2775156,2774913,2775146,2774933,2775166,43015390,43015405,43015387,43015402,43015396,43015411,43015393,43015408,43015399,43015414,43015391,43015406,43015388,43015403,43015397,43015412,43015394,1531915,43015409,43015400,43015415,43015392,43015407,43015389,43015404,43015398,43015413,43015395,1531914,43015410,43015401,43015416,2730991,2731016,2730986,2731011,2731001,2731026,2730996,2731021,2731006,2731031,2730992,2731017,2730987,2731012,2731002,2731027,2730997,1531943,2731022,2731007,2731032,2730993,2731018,2730988,2731013,2731003,2731028,2730998,1531942,2731023,2731008,2731033,2730990,2731015,2730985,2731010,2731000,2731025,2730995,2731020,2731005,2731030,2730989,2731014,2730984,2731009,2730999,2731024,2730994,2731019,2731004,2731029,1531927,1531925,1531923,1531926,1531924,1531922,42894342,42894339,42894351,42894348,42894345,42894336,42894337,42894341,42894338,42894350,42894347,42894344,42894335,2727474,2727472,2727604,2727602,2727606,2727471,2726967,2726949,2727003,2726985,2727021,2726973,2726955,2727009,2726991,2727027,2726964,2726946,2727000,2726982,2727018,2726970,2726952,2727006,2726988,2727024,2726977,2726959,2727013,2726995,2727031,2726966,2726948,2727002,2726984,2727020,2726972,2726954,2727008,2726990,2727026,2726961,2727015,2726963,2726945,2726999,2726981,2727017,2726969,2726951,2727005,2726987,2727023,2726975,2726957,2727011,2726993,2727029,2726976,2726958,2727012,2726994,2727030,2726965,2726947,2727001,2726983,2727019,2726971,2726953,2727007,2726989,2727025,2726960,2727014,2726962,2726944,2726998,2726980,2727016,2726968,2726950,2727004,2726986,2727022,2726974,2726956,2727010,2726992,2727028,2727662,2727454,2727452,2727458,2727456,2727460,2727451,2775646,2775679,2775662,2775695,2775654,2775687,2775670,2775894,2775644,2775660,2775652,2775668,2775643,2775676,2775659,2775692,2775651,2775684,2775667,2775700,2775648,2775664,2775656,2775673,2775672,2775647,2775663,2775655,2775671,2775645,2775661,2775653,2775669,2775642,2775658,2775650,2775666,2775641,2775657,2775649,2775665,2747464,2747477,2747489,2747470,2747483,2747495,2747467,2747476,2747480,2747492,2747473,2747486,2747498,2747466,2747479,2747491,2747472,2747485,2747497,2747469,2747482,2747494,2747475,2747488,2747500,2747465,2747478,2747490,2747471,2747484,2747496,2747468,2747481,2747493,2747474,2747487,2747499,2730679,2730694,2730676,2730691,2730685,2730700,2730682,2730697,2730688,2730703,2730678,2730693,2730675,2730690,2730684,2730699,2730681,2730696,2730687,2730702,2730677,2730692,2730674,2730689,2730683,2730698,2730680,2730695,2730686,2730701,2748966,2749202,2748976,2749212,2748971,2748986,2749207,2748981,2749217,2748967,2748977,2748972,2748982,2748969,2748979,2748974,2748984,2748968,2748978,2748973,2748983,2748970,2749206,2748980,2749216,2748975,2749211,2748985,2749221,2725119,2725116,2725125,2725122,42894514,2725128,2725117,2725114,2725123,2725120,42894512,2725126,2725118,2725115,2725124,2725121,42894513,2725127,42894575,42894570,42894413,42894580,42894565,42894418,42894578,42894573,42894416,42894583,42894568,42894421,42894576,42894571,42894414,42894581,42894566,42894419,42894577,42894572,42894415,42894582,42894567,42894420,42894574,42894569,42894412,42894579,42894564,42894417,1531869,1531873,1531863,1531865,1531877,1531868,1531872,43015225,43015223,1531876,1531867,1531871,43015226,43015224,1531875,2725150,2725145,2725160,2725155,42894555,2725165,2725153,2725148,2725163,2725158,42894558,2725168,1531866,1531870,1531862,1531864,1531874,2725151,2725146,2725161,2725156,42894556,2725166,2725152,2725147,2725162,2725157,42894557,2725167,2725149,2725144,2725159,2725154,42894554,2725164,2746962,2746983,2747003,2746972,2746993,2747205,2746967,2746982,2746988,2747200,2746977,2746998,2747210,2746964,2746985,2747197,2746974,2746995,2747207,2746969,2746990,2747202,2746979,2747000,2747212,2746966,2746987,2747199,2746976,2746997,2747209,2746971,2746992,2747204,2746981,2747002,2747214,2746965,2746986,2747198,2746975,2746996,2747208,2746970,2746991,2747203,2746980,2747001,2747213,2746963,2746984,2747196,2746973,2746994,2747206,2746968,2746989,2747201,2746978,2746999,2747211,2747942,2747952,2747947,2747957,2747944,2747954,2747949,2747959,2747943,2747953,2747948,2747958,2747941,2748178,2747951,2748188,2747946,2748183,2747956,2748193,4087760,4171187,2107946,2107950,2107930,2107951,2107963,2107945,2107927,2107964,2107969,2107966,2107965,2107931,2107942,2107968,2107967,2107943,2107970,2107944,2107880,2107882,2107875,2107881,2107887,2107879,2107886,2107885,2107891,2107859,2107876,2107904,2107889,2107888,2107877,2107903,2107902,2107906,2107878,2107905,44511968,44512176,44512178,40487995,40487553,44783095,40488455,4140111,4225228,4231683,42872694,4018288,4017583,4017725,4018134,4018133,40487075,4071417,44510478,4070482,4139713,4069355,4067214,42872491,4067088,4067215,4066526,40489414,44512229,40487090,40490431,4066654,4066753,4066751,4066750,40487552,40487089,44512177,42872700,4066659,4140883,4068016,36685560,36685739,40489413,40487938,40489415,40488402,4125173,40483096,4070380,4144708,4069250,40483730,42872696,42872697,44783654,46272782,4238025,4117076,4283095,4123585,4142436,4141243,4230350,4047386,4161522,2108481,2108482,4138737,4262531,4003896,4165077,4137929,4197945,4152498,4001562,4111590,4339095,4110488,4242997,2109368,4121165,4342516,38001216,38001215,38001217,38001213,38001212,38001214,4232393,2109370,4261768,4247263,2109371,2109372,2109369,4145145,4131440,4010264,4165066,2109383,2109384,2109381,2109382,4139295,4097820,4213594,4265335,4242994,4149348,4332107,2109348,2003187,4120074,2109347,4110050,4032310,4215782,4128303,4327351,2109345,2109344,4085201,4229118,4023285,4231631,4208327,4260975,4346398,3189659,4260267,46270908,46273698,46270904,46270909,46270910,4159841,4235954,4233904,4076334,42536331,3171358,46270907,46270903,46270905,42539511,2005415,4206703,4346399,4209104,4209207,2104897,2104896,2105168,2105164,2105162,2104942,2104941,2104912,2104901,2105146,2104919,2104916,2104915,2105149,2105147,3179054,4029794,46272750,4341094,4238033,4342518,4340240,4227266,4163693,2109122,4288746,4063558,2109127,4068659,4068657,4067675,4187257,2109223,2110129,2109221,4002178,2109758,44510695,44510693,44811442,44510697,44510696,40487953,2109056,2109047,2109041,2109045,2109046,2109043,2109044,2109042,2109053,2109055,2109054,2109052,2109049,2109048,4229918,4170609,4023269,4028332,4162987,2109083,2110148,35609784,4273096,4194967,42536278,4239071,42538115,42536279,4175285,42538116,4338661,4206240,4337607,40757123,4023124,4021250,4086912,4306061,4130558,4306060,4341381,4103646,4113224,2792135,2791606,2109669,2109082,4138869,4144431,40487532,4071543,4071546,44790486,44791175,44514852,40487482,4142079,4144433,44790959,2104837,4070463,44509755,4070872,4079258,44809076,44790478,44790443,46272775,44514854,40492990,4079260,4212633,2103360,2110421,2110422,2110419,2110420,2110555,2110427,2110426,2110425,2110424,2110418,2110417,2110483,2110484,2110455,2110456,2110446,2110444,2110445,2110447,2110489,2110490,4101626,40488472,40488856,40489840,40489805,40490927,4260117,40489859,40492277,4235200,40492357,2110476,2110475,4049661,2110471,2110441,2110571,2110576,3184077,2110435,4232246,2110470,2110459,2110469,2110465,2110462,2110468,2110460,2110481,2110458,2110467,2110466,3184785,4194536,37208869,4083914,4120482,4086319,3187517,4204987,4222123,4165576,4171016,4264656,4160163,4096533,4297514,4142244,4021831,4184314,4184813,4145735,4144794,4017998,4144714,4152082,4128729,4123395,4298476,4043873,4023114,3171805,2109723,2109720,2109721,2109719,4302546,4216505,3187777,40487928,40486964,40492308,4172225,4168534,4031312,40488302,4030825,4269776,4265757,2002826,44807760,44813902,44807758,44809612,44809613,2107424,2750796,2750797,2750798,2753727,2753728,2753729,43016993,2750790,2750791,2750792,2750793,2750794,2750795,2741144,2741145,2741146,4139563,4135448,4327176,43015370,43015373,2731734,2731737,43015368,43015371,42896511,42896526,42896518,42896533,2731735,2731738,43015369,43015372,42896509,42896524,42896516,42896531,42896507,42896522,42896514,42896529,42896519,42896534,42896505,42896520,42896510,42896525,42896517,42896532,42896512,42896527,42896508,42896523,42896515,42896530,42896506,42896521,42896513,42896528,2731736,2731739,43015379,43015628,2731743,2731746,43015377,43015380,42896593,42896608,42896600,42896615,2731744,2731747,43015378,43015627,42896591,42896606,42896598,42896613,42896589,42896604,42896596,42896611,42896601,42896616,42896587,42896602,42896592,42896607,42896599,42896614,42896594,42896609,42896590,42896605,42896597,42896612,42896588,42896603,42896595,42896610,2731745,2731748,43015646,43015649,2731752,2731755,43015632,43015647,42896675,42896690,42896682,42896734,2731753,2731756,43015633,43015648,42896673,42896688,42896680,42896732,42896671,42896686,42896678,42896693,42896683,42896735,42896669,42896684,42896674,42896689,42896681,42896733,42896676,42896691,42896672,42896687,42896679,42896731,42896670,42896685,42896677,42896692,2731754,2731757,43015667,43015670,2731761,2731764,43015665,43015668,42896757,42896810,42896764,42896817,2731762,2731765,43015666,43015669,42896755,42896808,42896762,42896815,42896753,42896768,42896760,42896813,42896765,42896818,42896751,42896766,42896756,42896809,42896763,42896816,42896758,42896811,42896754,42896769,42896761,42896814,42896752,42896767,42896759,42896812,2731763,2731766,43015826,43015829,2732018,2732021,43015824,43015827,42896397,42896412,42896404,42896419,2732019,2732022,43015825,43015828,42896395,42896410,42896402,42896417,42896393,42896408,42896400,42896415,42896405,42896420,42896391,42896406,42896396,42896411,42896403,42896418,42896398,42896413,42896394,42896409,42896401,42896416,42896392,42896407,42896399,42896414,2732020,2732023,43015767,43015777,2731982,2731985,43015765,43015775,42896975,42896990,42896982,42896997,2731983,2731986,43015766,43015776,42896973,42896988,42896980,42896995,42896971,42896986,42896978,42896993,42896983,42896998,42896969,42896984,42896974,42896989,42896981,42896996,42896976,42896991,42896972,42896987,42896979,42896994,42896970,42896985,42896977,42896992,2731984,2731987,43015635,43015638,2732221,2732224,43015620,43015636,42896636,42896651,42896643,42896472,2732222,2732225,43015634,43015637,42896634,42896649,42896641,42896470,42896632,42896647,42896639,42896654,42896644,42896473,42896630,42896645,42896635,42896650,42896642,42896471,42896637,42896652,42896633,42896648,42896640,42896469,42896631,42896646,42896638,42896653,2732223,2732226,43015815,43015818,2732009,2732012,43015813,43015816,42896352,42896367,42896359,42896374,2732010,2732013,43015814,43015817,42896350,42896365,42896357,42896372,42896348,42896363,42896355,42896370,42896360,42896375,42896346,42896361,42896351,42896366,42896358,42896373,42896353,42896368,42896349,42896364,42896356,42896371,42896347,42896362,42896354,42896369,2732011,2732014,43015792,43015795,2731991,2731994,43015781,43015793,42897020,42897035,42897027,42896284,2731992,2731995,43015791,43015794,42897018,42897033,42897025,42896282,42897016,42897031,42897023,42896280,42897028,42896285,42897014,42897029,42897019,42897034,42897026,42896283,42897021,42897036,42897017,42897032,42897024,42896281,42897015,42897030,42897022,42897037,2731993,2731996,43015745,43015761,2731973,2731976,43015743,43015746,42896930,42896945,42896937,42896952,2731974,2731977,43015744,43015747,42896928,42896943,42896935,42896950,42896926,42896941,42896933,42896948,42896938,42896953,42896924,42896939,42896929,42896944,42896936,42896951,42896931,42896946,42896927,42896942,42896934,42896949,42896925,42896940,42896932,42896947,2731975,2731978,43015607,43015616,2732027,2732030,43015605,43015608,42896442,42896457,42896449,42896464,2732028,2732031,43015606,43015615,42896440,42896455,42896447,42896462,42896438,42896453,42896445,42896460,42896450,42896465,42896436,42896451,42896441,42896456,42896448,42896463,42896443,42896458,42896439,42896454,42896446,42896461,42896437,42896452,42896444,42896459,2732029,2732217,43015806,43015809,2732000,2732003,43015804,43015807,42896307,42896322,42896314,42896329,2732001,2732004,43015805,43015808,42896305,42896320,42896312,42896327,42896303,42896318,42896310,42896325,42896315,42896330,42896301,42896316,42896306,42896321,42896313,42896328,42896308,42896323,42896304,42896319,42896311,42896326,42896302,42896317,42896309,42896324,2732002,2732005,43015688,43015704,2731770,2731773,43015686,43015689,42896840,42896855,42896847,42896862,2731771,2731774,43015687,43015703,42896838,42896853,42896845,42896860,42896836,42896851,42896843,42896858,42896848,42896863,42896834,42896849,42896839,42896854,42896846,42896861,42896841,42896856,42896837,42896852,42896844,42896859,42896835,42896850,42896842,42896857,2731772,2731775,43015724,43015727,2731779,2731782,43015708,43015725,42896885,42896900,42896892,42896907,2731780,2731783,43015709,43015726,42896883,42896898,42896890,42896905,42896881,42896896,42896888,42896903,42896893,42896908,42896879,42896894,42896884,42896899,42896891,42896906,42896886,42896901,42896882,42896897,42896889,42896904,42896880,42896895,42896887,42896902,2731781,2731969,4221687,4275715,2107631,2107645,2107643,2107651,2107642,2107646,2107644,2107662,4244434,2108471,4124042,44799351,4205489,4310408,4068214,4222733,4238930,4247169,4143166,4283357,4253787,4196342,4062074,4211101,2108864,2108865,2758575,2758576,2758577,2758584,2758585,2758586,2758590,2758591,2758592,2758593,2758594,2758595,2758581,2758582,2758583,2758587,2758588,2758589,2758572,2758573,2758574,2758602,2758603,2758604,4210173,4051624,2109035,2109036,2109319,2109323,2109324,2109325,4193124,2721091,2109422,2106870,2749965,2749967,4144378,4294397,4123910,4125298,4168531,2003002,2109420,4123584,4145504,4124305,4252245,4005724,4166047,4288733,4032768,44782975,44782976,3188936,2107519,2107517,2107532,2107518,2107533,2107520,2107521,8870,581381,9203,262,44512167,44512168,44512170,44512165,44512214,44512219,44512220,44512215,44512216,44512217,44512218,44512166,44512169,4307204,4307481,4307206,4284100,4194238,4234963,4234939,4231551,4234941,4226831,4234938,4231550,4231549,4234948,4234940,4234946,4234947,4231552,4225217,4231672,4231553,4225082,4226817,4231530,4231547,4234822,4231546,4225215,4234945,4225216,4234942,4234944,4234943,4231531,4225084,4225083,4226816,4231528,4225081,4226948,42872704,40490437,4172227,40486127,40489434,4168541,4050137,4295138,4170544,4021872,4298704,4024104,4262264,4020948,4052116,4020949,4021878,4050138,4049551,4051017,4051016,4081404,4031980,4051014,4049552,4019422,4231661,4261515,4052232,4146781,4141023,40492492,4052115,4226833,4050260,4262936,4225375,4052233,4022621,4049553,4022032,4081709,4019336,4051018,4050139,42872522,4183308,4020946,4019124,44512134,44512133,2002030,2002027,4147077,3186130,4032738,35609785,44809471,2002250,44791481,40480196,44783073,4235199,4258555,40483707,4259553,2107426,2107427,2107600,2211644,40756876,40757028,2211642,2107577,2107574,2107576,44783074,2100958,4230238,4150688,2109033,2109032,2109031,2109029,2109028,2109030,4264416,2109760,2109034,4314436,4071889,4343565,46271212,4327813,4123741,4187533,4144935,4139547,4139548,725062,4229584,4321434,4290158,4233368,4088171,4194984,4165374,4229309,4074215,4070855,4221409,4009622,4284544,4190708,4031793,2108932,2108933,4033072,4195840,4302173,3183028,4211860,2103361,4141227,4146476,2109027,2109026,2763265,2763267,2763269,2763271,2763273,2763275,2750933,2750935,2750939,2750722,2750724,2750728,2747070,2747259,2747263,2747267,2747269,2747273,2752039,2752041,2744438,2744633,2744635,2744637,2744639,2784140,2784142,2780085,2780087,2747060,2747062,2747066,2780139,2780141,2780145,2780340,2751612,2780054,2780048,2780050,2780052,2747287,2747289,2747293,2746796,2746798,2746802,2746543,2746743,2746747,2746751,2746753,2746757,2750676,2750678,43017110,2734505,2734507,2734509,2747020,2747022,2747026,2747010,2747012,2747016,2746806,2746808,2747006,2747030,2747032,2747036,2752027,2752029,2728682,2728686,2747050,2747052,2747056,2750481,2750483,2750485,2744408,2744410,2744414,2744416,2744428,2744430,2744432,2744434,2744436,2784130,2784132,2784136,2784138,2766257,2766259,2744388,2744390,2744394,2744396,2750469,2750471,2750473,2746533,2746535,2746539,2744398,2744400,2744404,2744406,4266210,2109135,2746523,2746525,2746529,4045255,2750943,2750945,2750732,2750734,2750738,2747307,2747309,2747313,2752033,2752035,2728676,2728680,2747040,2747042,2747046,2750475,2750477,2750479,2744378,2744380,2744384,2744386,2744418,2744420,2744422,2744424,2744426,2744177,2744179,2744374,2744376,2784120,2784122,2784126,2784128,2766063,2766065,2744167,2744169,2744173,2744175,2747297,2747299,2747303,2746786,2746788,2746792,2738418,2738420,2738422,2763259,2763261,2763263,2746762,2746760,2746765,2746763,2746776,2746778,2746782,2746771,2746769,2747277,2747279,2747283,2746513,2746515,2746519,2780129,2780131,2780135,4120426,4067193,4001894,4145983,2109405,4000607,4067688,4304011,4126235,4045403,4125467,37109505,4202223,46270888,4123632,4185709,4337610,4200391,4085269,4217842,2110158,2110159,2110160,2110161,2110162,4273387,4121746,709956,2102700,709957,2102712,2102701,4105220,2107405,2107402,4144206,4079713,4017599,4136782,4224846,4302672,4218096,4231441,4306486,4298165,4303290,4290265,4010354,4128715,4128716,4128714,4342537,4155084,4074426,46270891,4047793,37204027,4296537,4121239,3178682,4187092,4125468,4010116,4012911,4120425,4311267,4142987,2109164,4141228,4226535,4120960,4062979,40482705,40487106,4290887,37111500,4263586,4068201,4304998,4163526,4291773,4110840,4264661,4073385,4314569,4230220,4098273,44510560,4068985,4066641,4235570,4216250,4300860,4183741,4262433,4023417,4168628,2109401,42572618,4217165,4067932,4194372,4217030,4281511,4283229,4138691,4068842,4027855,4028656,4167655,4338234,2002389,2108851,2108852,4144195,3175055,4339615,4143174,40490008,4312089,4269215,4311944,4084965,4237222,42538147,42538148,42537535,40489329,40488819,4141662,4145558,4141241,4194744,40480531,4228336,4144801,4124049,2108771,40485422,40483733,4027552,40483732,4117580,4229920,4067284,4062763,40493295,4123406,4300501,4165586,2109163,2109162,40490505,3186082,2109166,40756915,40756981,2101766,40488438,40485319,4327818,4117188,4243775,4281667,4194589,4199792,4127484,4070582,4288312,4126462,2103359,37111501,4127100,40484127,4234425,4335477,4335476,4070880,4339612,4339611,4337036,4150691,3186454,4170227,4179344,4069345,4068389,4127103,46270085,4272615,4130184,4183993,4049409,4030690,4032108,2002387,4308819,2108961,2108960,4017454,3180040,2108021,2108020,2108032,2108019,4065445,2000293,2109219,4100051,4013054,4075430,2110043,4125321,4123402,4141254,4120957,4017464,44510657,4017602,44811323,4018274,4136779,4142327,2750959,2750960,1531956,1531954,1531950,1531952,1531948,1531955,1531951,1531953,1531949,45763716,4306113,4031498,4335478,4339613,4183316,2720496,4125766,4268321,4226952,4040974,4104343,4224292,4070337,4259121,4012936,4175600,44782966,4231673,4209860,4226951,44782968,4231676,4231675,4225234,4226961,4236714,4231810,44783093,4231812,4226018,4226019,4236622,4234800,4226700,4225224,4226963,4226011,4231677,4226953,4231674,4231689,4236705,4226949,4226955,4226954,4226956,4052256,4226815,4049678,4019421,4194865,4030099,4209861,4194864,4166196,4299926,4080163,4322480,4173452,46273493,4169455,4168037,46271819,42535332,4169783,4170080,4303662,46272791,4303398,42535329,42539224,4303806,4168349,46273958,42539223,42535330,4170923,4167560,46271676,42538269,42539167,42539172,46271672,4199513,44812223,3180822,4275133,4218478,2751200,2751195,2751196,2751197,2751198,2751199,4341095,4175802,2772316,2772322,2772315,2772321,2772314,2772320,2772318,2772324,2772317,2772323,2772110,2772304,2772109,2772303,2772108,2772302,2772112,2772306,2772111,2772305,4003868,4002567,4002073,4002070,4001173,4120076,4003871,4188920,4227752,4224792,4059405,4263057,4068520,4314674,4049663,4203442,4234134,2108967,2108968,2108965,2108966,2108963,2108962,2108964,4300428,2109001,2109002,2109003,2108999,4221722,2108992,4229321,4121242,2108938,2108937,4123891,4333221,4249571,2108994,2108993,4204677,2108996,2108997,2108995,4041847,2108645,2108644,2108640,4117059,4042907,4235030,3190674,3180483,2104835,45769231,4221665,4012942,4187106,4032564,2109315,2109317,2109318,2109316,4270222,4247012,4251035,3169568,4077452,4278667,4055638,4266990,4213873,4173612,2791881,2791877,2791879,2791878,2791882,2791880,2791359,2791355,2791357,2791356,2791360,2791358,2791832,2791828,2791830,2791829,2791833,2791831,4294869,4183329,4173511,4141900,4127886,4125788,4082045,4118724,4022958,4201147,4066651,4066652,4068264,4068028,4146616,4320913,4125308,4078310,4282598,4193922,4234136,4297324,4218743,4173118,4199270,2109079,4013486,4298956,4068030,3175777,3174167,4236708,4231830,4226012,4231690,4231808,4236707,4226967,4225227,4226958,4236709,4231679,4225225,4231809,4226962,4226957,4225226,4231811,4226965,4226014,4226964,4194866,4163331,4049679,4307198,4180074,4240458,4027870,4125466,44807759,44809460,44807757,44809453,44809454,2100816,2107910,2107909,2107911,4220986,4291953,4284828,2109139,2109140,4326107,35624144,4000077,4239564,4323141,2110584,4320776,4061287,44783086,40487891,4185899,4312857,3169123,2110494,4120959,2108488,2108487,4144418,2763933,2763940,2763947,2763211,2763218,2763926,2763938,2763945,2763952,2763216,2763223,2763931,2751454,2763932,2763939,2763946,2763210,2763217,2763925,2763934,2763941,2763948,2763212,2763219,2763927,2763935,2763942,2763949,2763213,2763220,2763928,2751453,2763936,2763943,2763950,2763214,2763221,2763929,43017225,2763937,2763944,2763951,2763215,2763222,2763930,4233173,4206533,4260970,4188287,4197175,4197176,2109418,2109417,4315036,4002375,4151641,4147879,4128724,4314806,4017462,4120657,4245767,4121236,4272344,3173133,4231432,4289770,4100317,4239323,4337037,4147307,4247419,2002482,4203164,4155857,4128727,4281532,2007976,2721109,2720495,4172219,4128563,4234122,4206169,4122238,4319281,4135346,4232489,4024644,4234135,4140882,4246722,4160710,4238558,4095697,4054580,4268174,2002984,2000811,2003223,38001219,38001218,38001220,44783604,44808479,42537389,44809602,761093,44807787,44807788,44809645,44807783,44809029,3186656,3178004,44807929,44807933,2002911,44809616,44809617,44807930,44807934,2000810,44807813,44807814,2003224,2000809,3175828,3187716,2002969,44808438,46270641,44809642,44809643,44807797,44807798,37399470,44807802,44807803,44807806,44807809,2002768,44783607,44783606,44783652,46270642,44807786,44809644,44807812,44807801,44807805,44807794,2109075,2109060,2108974,2108975,2109074,2110210,2110212,2722214,2722215,2722216,2109065,2109068,2109069,2109067,2109066,2109072,2109073,2109071,2109064,2109063,2109059,2109058,2109207,2109206,2722219,2109680,2108477,2108478,4029565,4074288,2002786,2106446,2106444,4305958,4099026,4127090,4120958,4261788,4124045,4219780,3174915,3178454,4144204,4018281,44811437,4017469,44510681,44510680,4199952,4197728,4197173,3170494,4114635,4068390,3182820,4074876,3181476,4235394,4235396,4248544,4200989,4326257,2000313,2108474,2108475,4267225,4202578,4125320,4030150,4183332,4312613,4035186,37111477,37111476,4070879,4337606,3177572,37111478,37111479,4337605,36676344,46273729,4125323,36676345,2002724,40484108,2002448,2002545,4060874,2002964,4121233,4269909,4322181,4072705,4046830,2791887,2791883,2791885,2791884,2791888,2791886,2791365,2791361,2791363,2791362,2791366,2791364,2791838,2791834,2791836,2791835,2791839,2791837,3175444,4151121,40489970,40487521,4000882,4119250,4323902,4199456,4033555,4206184,36676819,4070869,4128728,4219628,4151354,4323555,4243317,4123565,44511357,4217222,40491372,2102736,42735001,2102721,42733288,2102735,42733287,2102734,42732332,4235027,4128562,2811735,2852039,2839188,2852040,2824254,2839189,2896962,2865143,2856912,2856913,2896830,2878473,2803645,2816396,2884028,2798725,2851973,2859508,2851974,2806408,2806409,2873516,2836752,2836753,2900019,2900020,2798726,2865415,2806410,2886621,2851975,2886620,2900021,2819273,2819274,2836755,2851976,2798728,2836754,2798727,2819144,2819145,2886619,2811834,2859507,2798724,2839285,2846747,2900017,2819271,2846748,2839287,2839286,2873513,2878572,2851972,2865413,2865414,2832231,2819272,2873515,2846749,2900018,2878573,2873514,2852443,2847246,2884479,2806763,2884478,2852444,2863245,2837118,2876384,2847245,2871225,2832597,2824511,2837119,2852446,2859995,2806764,2852445,2799222,2892022,2863246,2837120,2806765,2806766,2876385,2824512,2819624,2819622,2863244,2897878,2837115,2884474,2897873,2871223,2819623,2897872,2884475,2852317,2832595,2863243,2859994,2897874,2859993,2837116,2884476,2897875,2832596,2892021,2884477,2871224,2837117,2897876,2806762,2897877,2832272,2878786,2818987,2801384,2818986,2832273,2897565,2846978,2859891,2886663,2859890,2851997,2806786,2801383,2865629,2865630,2859889,2846977,2865770,2806799,2873712,2891751,2852010,2897579,2818998,2860031,2824740,2897577,2832280,2806798,2886676,2824741,2865767,2818997,2860039,2832288,2801395,2897589,2819001,2806800,2824744,2886683,2865772,2824743,2897588,2832287,2886684,2860038,2891748,2847123,1535346,2824742,2814788,2814787,2886678,2891749,2814786,2886677,1534094,2865764,2801392,1535636,2865765,2824739,2865766,2847122,2801393,2806797,2847121,1536396,4195806,4296174,4022910,2109040,4012004,4191943,4216480,4216479,4191857,4185246,4250795,4337035,2110172,2110173,2110174,3176407,4011698,2109569,2109570,2109571,4283658,4267744,4128726,44509566,44509564,2109450,4306298,44513528,2110263,44807937,2002985,2002751,2002764,2002750,2002749,2002562,2002763,2002762,2002765,46285158,42872657,4335472,4202814,4070882,4068793,4068147,44509722,42872701,4070870,44807785,44813904,44807924,2107598,44809615,44807936,4142969,4128854,44807811,2002970,3169831,3175034,3180571,46270927,43531122,40479276,4286744,46270928,4211987,4234790,3177144,2005457,40479217,4139169,2107596,2107597,2107595,43531174,44809619,44807796,44807800,44807804,2002769,44807793,2104900,2104899,2105167,2104943,2104914,2105151,2105150,2105166,2105165,2104920,2104934,2104898,4068200,4047234,4312749,4059308,4241198,4187072,2111083,2111082,2111081,2103373,2721116,2002986,2003815,2003724,2003708,2002770,2002990,2002490,2002488,2002909,2003243,2003190,2003191,2000111,2002828,2002825,2001345,2002745,2003230,2002607,2002531,2002922,2002483,2002471,2002469,2000836,2001340,2002722,2004207,2002927,2002924,2002409,2000308,2003211,2002550,2003350,2002747,2002823,2002971,2004263,2004248,2004249,2004264,2002987,2003003,2002785,44512793,44510520,44509766,44510597,44510711,44510479,44510571,44510525,44510324,44510367,44510934,44509742,44509750,44510589,44508218,44512768,44510469,44510316,44510913,44510557,44510511,44510683,44509435,44509567,44510833,44510691,44510675,44510660,44515504,44515510,44510334,44513926,44514266,44508876,44512230,44512179,44510578,44509759,44511834,44512221,44512171,44510638,44510699,44510667,44511358,44510339,44508882,44510643,44510350,44511365,44510921,44514858,44514793,44513350,44510224,44509582,44513613,44509719,44512183,44512115,44510329,44512702,44510807,44510344,44510653,44510648,44509574,44510907,44511354,44509712,44514784,44514777,44512798,2002565,2003966,2004243,2004246,42572793,4124311,4184780,4141456,2109403,2109402,2109404,2109408,2109409,2109406,2109407,2109410,2109411,4298330,4238339,4165270,4020329,4144849,4139996,4243032,3186345,4125325,4185654,2109421,44807810,44510647,4138848,4237501,4122647,4141142,4254094,4233960,4068656,4137288,4028033,4195151,4221568,4229775,4259115,4326904,4249151,4069165,4070365,4070858,4071282,4140874,4128564,4123737,4124531,2108857,2108859,2108858,2108860,2108862,2108861,4068757,4067560,4070969,4071649,40488475,42872490,4144185,4098879,4144719,4252381,4184913,40492756,44509714,44509716,4071537,2002548,2002547,2002549,4233414,4124303,4322818,4225800,4137612,4297365,37017416,4300373,4232708,4075872,4019076,4066414,4067917,37017273,4231736,44509581,4106090,4336819,4181781,42539745,4273758,4331443,4123738,4281839,4143536,4147863,4116474,4150544,4151313,4148815,4121987,4193680,2108677,1314384,4077239,2109161,2110180,2109725,4030412,2108489,4144723,4166293,2002827,2002605,4109322,43531508,4333625,4160429,4049540,4050130,4049542,4052111,4052108,4049543,4052109,4067681,40485349,4067682,4190631,4171415,4081184,4174903,4172230,4174906,4081186,4081188,4174592,4174905,4171416,4174591,4174586,4174902,4172228,4174589,4081185,4174585,4081187,4174904,4068753,4333080,4196019,4197887,4329372,46270882,4081205,2105163,2104913,4231647,4216131,4197637,40491943,40491012,4332920,4202290,4328406,4202442,4307479,40491490,4330361,4196013,4237121,4160718,4160996,40486124,4160988,4034706,44512143,37019024,4179665,4205071,4204137,4204277,4196458,4330375,4162777,4199843,4199234,4200624,4198464,4070947,4144171,4227125,4122309,4176100,44510832,4224467,4087495,4244866,4306150,4279534,4184588,4204213,4165736,2106462,2106451,4068662,40489464,2109394,2109395,2211643,2109078,44510635,2792137,2791609,2792346,4022030,4339614,4337608,4144928,4131656,4123398,4049680,4251627,4066805,4142182,4082972,2109375,44512701,40488352,4151122,4190935,4163366,4194666,4120293,4142076,4076328,4077625,4079102,44515513,4177835,4175642,4152063,4079100,4077622,4215700,4075909,4078962,4144424,4343557,4343476,4343558,4346396,4343342,4343341,44809176,2108323,2108324,44514853,42872820,4076471,4079259,4148762,4068146,4187917,4097307,3179339,2109157,2109153,2109158,2109155,2109156,2109154,2109160,2109151,2109152,2109216,4250893,4172146,44510636,3170635,3190340,37017085,2110034,2110039,4150990,4143687,4140294,4067888,4124044,4021544,4308113,4235310,4021082,4230237,2107457,4143686,4218783,4030108,4124304,4233982,4071550,4211709,4022013,4020330,4146777,2110179,4200549,4216658,4021570,4243049,2111196,4012321,4100937,2002329,4143045,4117075,4021530,45773577,45769917,4302897,4231761,4164300,2002310,2002311,4022014,4023416,4117192,4243467,4096783,4071666,4073695,4073008,2103375,2103376,4187904,4198981,4262130,4281388,4193240,4284969,4185981,3176453,4067445,2752006,4341372,46271347,42539071,4052243,4049670,4071286,4141022,4050272,46232737,4022029,4050271,4049671,2109389,4166761,4347169,4181584,4069008,4144720,4207599,2110574,4157076,4074105,4073029,4269338,44783434,4120399,42538471,2747346,2747347,2747349,2747350,2752226,2752227,43016971,2739909,2739910,44512511,2752477,2752479,2752480,2752478,43016982,4339303,4069222,4344636,4345349,37016991,4337613,2106762,2106751,2106763,2106765,2106764,2106766,2106767,2106748,2106750,2106749,37017704,3177626,4069779,4105082,2109039,2109426,4307677,4072534,2107777,2108001,2733567,2733568,2733569,2753339,2753340,2753341,2733570,2733571,2733572,2753002,2753003,2753004,43017036,2733573,2733574,2733575,2733576,2733577,2733578,2729854,2729855,2729856,2753333,2753334,2753335,2733588,2733589,2733590,2729860,2729861,2729862,2777588,2777585,2777586,2733597,2733598,2729853,2733591,2733592,2733593,45887730,2753336,2753337,2753338,2733585,2733586,2733587,2729857,2729858,2729859,2777584,2777581,2777582,2733594,2733595,2733596,2740448,2740449,2740450,2733579,2733580,2733581,2733582,2733583,2733584,44783567,36675127,4314003,4236715,4178877,4211380,4065199,44783064,45767562,4297402,40482204,40483558,4305183,4020804,4052253,4240244,4318938,4163833,4195762,4247144,42872712,37110863,4163966,4135319,3183949,2005882,2109273,2109272,4078308,42872711,40479983,3171400,4098862,4017331,4202217,4084297,4103396,4052846,4172318,2108426,4248215,4184775,4272502,44793143,4180605,4000088,3190209,44793144,4181152,4199966,2107425,4072584,3183261,2107310,4243023,2721170,1531680,2774092,2774086,2774088,2774087,2774089,2774091,2774090,2774080,2774082,2774081,2774083,2774085,2774084,2774096,43017843,43017845,43017844,2774093,2774095,2774094,2774116,2774113,2774115,2774114,2774110,2774112,2774111,2774311,2774107,2774109,2774108,2774117,2774310,2774118,2774363,2774360,2774362,2774361,2774357,2774359,2774358,2774367,2774364,2774366,2774365,2776487,2776490,2776493,2776496,2776489,2776492,2776495,2776498,2776488,2776491,2776494,2776497,1531681,2774061,2773863,2774057,2773864,2774058,2774060,2774059,2773857,2773859,2773858,2773860,2773862,2773861,2774065,43017840,43017842,43017841,2774062,2774064,2774063,2774075,2774072,2774074,2774073,2774069,2774071,2774070,2774079,2774066,2774068,2774067,2774076,2774078,2774077,2774352,2774349,2774351,2774350,2774346,2774348,2774347,2774356,2774353,2774355,2774354,2776475,2776478,2776481,2776484,2776477,2776480,2776483,2776486,2776476,2776479,2776482,2776485,2109671,4018936,4141020,44512205,44512210,44512211,44512206,44512207,44512209,4050282,44511980,2753286,2753591,2753592,2768661,2768668,2768675,2768665,2768672,2768679,2768660,2768667,2768674,2768662,2768669,2768676,2768663,2768670,2768677,2768664,2768671,2768678,2768681,2768666,2768673,2768680,2753593,2753594,2768452,2768459,2768466,2768456,2768463,2768657,2768451,2768458,2768465,2768453,2768460,2768467,2768454,2768461,2768468,2768455,2768462,2768656,2768659,2768457,2768464,2768658,2110265,2110267,2110266,2110271,2110272,2106768,3185760,2762111,2762112,3190118,2753522,2753524,2753382,2753384,2753386,2753388,2753620,2744456,2778687,2778689,2778690,2753378,2753380,2778903,2778905,2778906,2753514,2753516,2753517,2753394,2753396,2753160,2753162,2753140,2753142,2753144,2753146,2753504,2753172,2753174,2753168,2753170,2753164,2753166,2753176,2753368,2753616,2753374,2753376,2753502,2753503,2744450,2744454,2778682,2778684,2778685,2744446,2753498,2753499,2753136,2753138,2744448,2753132,2753134,2753534,2785345,2785346,2785348,2780477,2780478,2780479,2780480,2753402,2753404,2753618,2753370,2753372,2753500,2753501,2744444,2744452,2744442,2778677,2778679,2778680,2744440,2753398,2753400,2753156,2753158,2740690,2762110,2753148,2753152,2753154,2753150,2740664,2753390,2753392,2753128,2753130,2778898,43018211,43018213,43018214,2778900,3185358,2106770,2106769,4233416,4203422,4225750,761910,4264149,3168218,44789789,44510582,4135442,42732580,2108497,2108498,2106942,4232645,4226983,4216867,4104117,2106889,3187109,4067461,4183556,4203139,4302594,4001100,4222325,4144799,3179486,2109400,44510596,42538967,2108490,3170816,4079261,2750247,2750251,2777382,2767230,2767215,2767220,2777389,2767255,2767260,2766979,2766984,2767210,2766999,2767004,2777381,2777355,2777365,2767235,2767240,2766959,2766964,2750258,2777393,2777359,2777362,2777394,2777360,2777392,2777358,2777615,2777395,2777403,2777607,2777385,2777361,2777369,2777377,4069219,3176770,3168689,2109008,2109007,4090926,44809077,35625794,4017451,4133147,2109081,2109080,43531416,42536397,3181321,44514791,35625480,35625764,3179288,3179641,42536396,42539518,4220390,4166842,2104839,2104838,2104840,4077764,4077772,4076314,4075926,4079101,4077624,4075913,4077486,4075914,2108039,2108038,4233412,42538033,3173101,3178659,44510664,4199951,4018022,44811330,40487481,4018279,44788740,3188772,3172819,3186446,3181400,4120985,3186641,4072837,3176591,46270895,46273689,4147469,4309342,4305172,4168992,4251490,4069249,4200500,4144851,507338,4021363,2110248,44513524,4208945,4341384,4341893,4125166,4309197,4053102,4125983,4223385,2108325,4230250,4237615,4141123,4238340,4225427,4017608,4146634,44814047,4018283,44510689,4146633,4202562,4202563,4295434,4199605,4198242,4191930,4337604,4322713,4130394,4227605,4030148,4125160,4125148,4200964,4200965,4168529,4105856,4122805,4183445,4003877,4003878,4122317,4125482,2108424,2108423,2108425,4228698,4049156,4183160,4044879,4196637,4234933,4120444,4124306,4121241,4051031,4072416,45769911,45769914,45769913,44807572,4146034,37310744,4144205,4146036,42872470,44790503,42872471,4179807,44510912,4174035,4070209,2110318,4124310,4220195,4035975,4236171,3174690,4088798,4191371,2006458,4013045,4184917,2110177,4306070,42538159,4105608,42538160,2108480,4268770,4072147,4124041,40488357,4211701,4073019,4338954,2110296,2110297,2110293,2110294,4242804,2109119,4301002,4296082,4125484,2107101,4142661,40493483,4128861,915705,4189520,4277284,4127491,4297515,4224661,4017329,4173320,4069224,4301338,4290784,2108485,4301336,2106890,2106891,2001339,2001342,2001336,764458,2106829,42742521,42742516,42742518,42742517,42742519,2106811,2106823,2106686,4223107,2106705,42742509,42742508,4342517,4277450,4291474,4174853,4194514,4033394,2108034,2108035,4287324,4034809,4224154,4278676,3178879,4284252,3187036,3186126,4322950,4225213,4169059,4012935,4165203,4250501,4220354,4272176,4070815,4296476,4218276,4170199,4071694,4174417,4085263,4173565,4227604,4293019,4220694,4245398,4251929,4244381,4221138,4094373,4218467,4059892,4236041,4035152,4309979,4299645,4233645,4049901,4286493,4277594,4217800,4327353,4324414,4197948,4288016,4308579,4311546,4200085,4058182,2107758,2107757,2107740,2107772,2107773,2107774,2107775,2107755,2107760,2107761,2107759,2107752,2107756,2107741,2107754,2107753,2110372,2110373,4262950,4163975,4260388,4149741,4197412,4021531,2110175,2110176,40487862,35624727,4019096,2110178,4272254,4035487,44510313,4067672,4069218,4096461,4145225,4141259,4146636,4029954,4071281,4140875,4295728,4070481,4236032,4131021,4070373,44509711,4070372,4071534,4231795,4239077,4120065,4066035,4023403,35624726,35624728,42538161,42539767,42538163,4312859,42538162,42538181,42538164,4292716,4022012,4066413,4066412,4066411,4310244,4234745,4224347,4107409,40487833,44508885,44508884,4129187,44508886,4194416,2108856,2108855,2108854,2108853,2108863,4316068,4067886,4328359,4286807,4172438,4128860,4144432,4138868,4203771,36674771,40481495,4279125,4018300,4018301,2110156,4122235,40482769,4334487,4152086,4074416,4181291,4067784,2752708,2752709,4141021,2211654,2107779,2107797,2211653,4049531,40756966,40756834,40756881,4193904,4147449,4265621,4083510,4217180,4069006,4069005,4217151,2109660,4234536,4287859,709967,2107423,4097958,4017466,4144203,44811428,4018024,44510673,4146632,4201948,4202561,4261365,2104918,2104917,2110328,2104861,4087400,4032641,4059252,2109019,4235025,2110559,2110560,2110557,2110558,4231725,2109391,46272964,2000307,2000294,2006433,2004231,44513527,2006421,2004244,44513523,4117056,42537387,42537388,4267068,2109658,4063559,2109667,4235644,4023268,4020344,2109665,4348166,2109654,4308446,2109662,2109661,2109663,2109664,4107717,2109657,4212113,2109666,4021253,2109659,761973,4340649,2109670,4300374,4169931,3185447,4073268,4138738,40490442,45769916,42538817,45769915,4013493,4270052,4136878,4299781,4099316,44783696,4185055,4184653,4147073,2110181,2110182,2110183,2110185,2110189,2110190,2110191,2110193,2110188,2110186,2110187,4148976,4130188,4234429,2110095,2110092,2108973,2108972,2108969,4229447,4058634,4318648,2110013,4239081,46273604,4299772,4142397,2110071,2110070,2110069,2110067,2110066,4235024,4185234,40486632,4337034,4021543,40493194,4069129,4021542,4142326,4234972,2110261,4263094,4263350,4301112,4213269,4339290,4012912,4166301,2002965)

) I
) C
;

with primary_events (event_id, person_id, start_date, end_date, op_start_date, op_end_date, visit_occurrence_id) as
(
-- Begin Primary Events
select P.ordinal as event_id, P.person_id, P.start_date, P.end_date, op_start_date, op_end_date, cast(P.visit_occurrence_id as bigint) as visit_occurrence_id
FROM
(
  select E.person_id, E.start_date, E.end_date,
         row_number() OVER (PARTITION BY E.person_id ORDER BY E.sort_date ASC) ordinal,
         OP.observation_period_start_date as op_start_date, OP.observation_period_end_date as op_end_date, cast(E.visit_occurrence_id as bigint) as visit_occurrence_id
  FROM 
  (
  -- Begin Visit Occurrence Criteria
select C.person_id, C.visit_occurrence_id as event_id, C.visit_start_date as start_date, C.visit_end_date as end_date,
       C.visit_occurrence_id, C.visit_start_date as sort_date
from 
(
  select vo.* 
  FROM @cdm_database_schema.VISIT_OCCURRENCE vo
JOIN #Codesets cs on (vo.visit_concept_id = cs.concept_id and cs.codeset_id = 5)
) C

WHERE (C.visit_start_date >= DATEFROMPARTS(2019, 12, 1) and C.visit_start_date <= DATEFROMPARTS(2021, 11, 1))
-- End Visit Occurrence Criteria

  ) E
	JOIN @cdm_database_schema.observation_period OP on E.person_id = OP.person_id and E.start_date >=  OP.observation_period_start_date and E.start_date <= op.observation_period_end_date
  WHERE DATEADD(day,0,OP.OBSERVATION_PERIOD_START_DATE) <= E.START_DATE AND DATEADD(day,0,E.START_DATE) <= OP.OBSERVATION_PERIOD_END_DATE
) P

-- End Primary Events

)
SELECT event_id, person_id, start_date, end_date, op_start_date, op_end_date, visit_occurrence_id
INTO #qualified_events
FROM 
(
  select pe.event_id, pe.person_id, pe.start_date, pe.end_date, pe.op_start_date, pe.op_end_date, row_number() over (partition by pe.person_id order by pe.start_date ASC) as ordinal, cast(pe.visit_occurrence_id as bigint) as visit_occurrence_id
  FROM primary_events pe
  
JOIN (
-- Begin Criteria Group
select 0 as index_id, person_id, event_id
FROM
(
  select E.person_id, E.event_id 
  FROM primary_events E
  INNER JOIN
  (
    -- Begin Correlated Criteria
select 0 as index_id, cc.person_id, cc.event_id
from (SELECT p.person_id, p.event_id 
FROM primary_events P
JOIN (
  -- Begin Measurement Criteria
select C.person_id, C.measurement_id as event_id, C.measurement_date as start_date, DATEADD(d,1,C.measurement_date) as END_DATE,
       C.visit_occurrence_id, C.measurement_date as sort_date
from 
(
  select m.* 
  FROM @cdm_database_schema.MEASUREMENT m
JOIN #Codesets cs on (m.measurement_concept_id = cs.concept_id and cs.codeset_id = 1)
) C


-- End Measurement Criteria

) A on A.person_id = P.person_id  AND A.START_DATE >= P.OP_START_DATE AND A.START_DATE <= P.OP_END_DATE AND A.END_DATE >= DATEADD(day,-21,P.START_DATE) AND A.END_DATE <= DATEADD(day,7,P.START_DATE) ) cc 
GROUP BY cc.person_id, cc.event_id
HAVING COUNT(cc.event_id) >= 1
-- End Correlated Criteria

UNION ALL
-- Begin Correlated Criteria
select 1 as index_id, cc.person_id, cc.event_id
from (SELECT p.person_id, p.event_id 
FROM primary_events P
JOIN (
  -- Begin Measurement Criteria
select C.person_id, C.measurement_id as event_id, C.measurement_date as start_date, DATEADD(d,1,C.measurement_date) as END_DATE,
       C.visit_occurrence_id, C.measurement_date as sort_date
from 
(
  select m.* 
  FROM @cdm_database_schema.MEASUREMENT m
JOIN #Codesets cs on (m.measurement_concept_id = cs.concept_id and cs.codeset_id = 2)
) C

WHERE C.value_as_concept_id in (4126681,45877985,9191,45884084,4181412,45879438)
-- End Measurement Criteria

) A on A.person_id = P.person_id  AND A.START_DATE >= P.OP_START_DATE AND A.START_DATE <= P.OP_END_DATE AND A.START_DATE >= DATEADD(day,-21,P.START_DATE) AND A.START_DATE <= DATEADD(day,7,P.START_DATE) ) cc 
GROUP BY cc.person_id, cc.event_id
HAVING COUNT(cc.event_id) >= 1
-- End Correlated Criteria

UNION ALL
-- Begin Correlated Criteria
select 2 as index_id, cc.person_id, cc.event_id
from (SELECT p.person_id, p.event_id 
FROM primary_events P
JOIN (
  -- Begin Observation Criteria
select C.person_id, C.observation_id as event_id, C.observation_date as start_date, DATEADD(d,1,C.observation_date) as END_DATE,
       C.visit_occurrence_id, C.observation_date as sort_date
from 
(
  select o.* 
  FROM @cdm_database_schema.OBSERVATION o
JOIN #Codesets cs on (o.observation_concept_id = cs.concept_id and cs.codeset_id = 2)
) C

WHERE C.value_as_concept_id in (4126681,45877985,9191,45884084,4181412,45879438)
-- End Observation Criteria

) A on A.person_id = P.person_id  AND A.START_DATE >= P.OP_START_DATE AND A.START_DATE <= P.OP_END_DATE AND A.START_DATE >= DATEADD(day,-21,P.START_DATE) AND A.START_DATE <= DATEADD(day,7,P.START_DATE) ) cc 
GROUP BY cc.person_id, cc.event_id
HAVING COUNT(cc.event_id) >= 1
-- End Correlated Criteria

UNION ALL
-- Begin Correlated Criteria
select 3 as index_id, cc.person_id, cc.event_id
from (SELECT p.person_id, p.event_id 
FROM primary_events P
JOIN (
  -- Begin Condition Occurrence Criteria
SELECT C.person_id, C.condition_occurrence_id as event_id, C.condition_start_date as start_date, COALESCE(C.condition_end_date, DATEADD(day,1,C.condition_start_date)) as end_date,
  C.visit_occurrence_id, C.condition_start_date as sort_date
FROM 
(
  SELECT co.* 
  FROM @cdm_database_schema.CONDITION_OCCURRENCE co
  JOIN #Codesets cs on (co.condition_concept_id = cs.concept_id and cs.codeset_id = 4)
) C


-- End Condition Occurrence Criteria

) A on A.person_id = P.person_id  AND A.START_DATE >= P.OP_START_DATE AND A.START_DATE <= P.OP_END_DATE AND A.START_DATE >= DATEADD(day,-1,P.START_DATE) AND A.START_DATE <= P.OP_END_DATE AND A.START_DATE >= P.OP_START_DATE AND A.START_DATE <= DATEADD(day,0,P.END_DATE) ) cc 
GROUP BY cc.person_id, cc.event_id
HAVING COUNT(cc.event_id) >= 1
-- End Correlated Criteria

  ) CQ on E.person_id = CQ.person_id and E.event_id = CQ.event_id
  GROUP BY E.person_id, E.event_id
  HAVING COUNT(index_id) > 0
) G
-- End Criteria Group
) AC on AC.person_id = pe.person_id and AC.event_id = pe.event_id

) QE
WHERE QE.ordinal = 1
;

--- Inclusion Rule Inserts

create table #inclusion_events (inclusion_rule_id bigint,
	person_id bigint,
	event_id bigint
);

with cteIncludedEvents(event_id, person_id, start_date, end_date, op_start_date, op_end_date, ordinal) as
(
  SELECT event_id, person_id, start_date, end_date, op_start_date, op_end_date, row_number() over (partition by person_id order by start_date ASC) as ordinal
  from
  (
    select Q.event_id, Q.person_id, Q.start_date, Q.end_date, Q.op_start_date, Q.op_end_date, SUM(coalesce(POWER(cast(2 as bigint), I.inclusion_rule_id), 0)) as inclusion_rule_mask
    from #qualified_events Q
    LEFT JOIN #inclusion_events I on I.person_id = Q.person_id and I.event_id = Q.event_id
    GROUP BY Q.event_id, Q.person_id, Q.start_date, Q.end_date, Q.op_start_date, Q.op_end_date
  ) MG -- matching groups

)
select event_id, person_id, start_date, end_date, op_start_date, op_end_date
into #included_events
FROM cteIncludedEvents Results
WHERE Results.ordinal = 1
;



-- generate cohort periods into #final_cohort
with cohort_ends (event_id, person_id, end_date) as
(
	-- cohort exit dates
  -- By default, cohort exit at the event's op end date
select event_id, person_id, op_end_date as end_date from #included_events
),
first_ends (person_id, start_date, end_date) as
(
	select F.person_id, F.start_date, F.end_date
	FROM (
	  select I.event_id, I.person_id, I.start_date, E.end_date, row_number() over (partition by I.person_id, I.event_id order by E.end_date) as ordinal 
	  from #included_events I
	  join cohort_ends E on I.event_id = E.event_id and I.person_id = E.person_id and E.end_date >= I.start_date
	) F
	WHERE F.ordinal = 1
)
select person_id, start_date, end_date
INTO #cohort_rows
from first_ends;

with cteEndDates (person_id, end_date) AS -- the magic
(	
	SELECT
		person_id
		, DATEADD(day,-1 * 90, event_date)  as end_date
	FROM
	(
		SELECT
			person_id
			, event_date
			, event_type
			, MAX(start_ordinal) OVER (PARTITION BY person_id ORDER BY event_date, event_type ROWS UNBOUNDED PRECEDING) AS start_ordinal 
			, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY event_date, event_type) AS overall_ord
		FROM
		(
			SELECT
				person_id
				, start_date AS event_date
				, -1 AS event_type
				, ROW_NUMBER() OVER (PARTITION BY person_id ORDER BY start_date) AS start_ordinal
			FROM #cohort_rows
		
			UNION ALL
		

			SELECT
				person_id
				, DATEADD(day,90,end_date) as end_date
				, 1 AS event_type
				, NULL
			FROM #cohort_rows
		) RAWDATA
	) e
	WHERE (2 * e.start_ordinal) - e.overall_ord = 0
),
cteEnds (person_id, start_date, end_date) AS
(
	SELECT
		 c.person_id
		, c.start_date
		, MIN(e.end_date) AS end_date
	FROM #cohort_rows c
	JOIN cteEndDates e ON c.person_id = e.person_id AND e.end_date >= c.start_date
	GROUP BY c.person_id, c.start_date
)
select person_id, min(start_date) as start_date, end_date
into #final_cohort
from cteEnds
group by person_id, end_date
;

DELETE FROM @target_database_schema.@target_cohort_table where cohort_definition_id = @target_cohort_id;
INSERT INTO @target_database_schema.@target_cohort_table (cohort_definition_id, subject_id, cohort_start_date, cohort_end_date)
select @target_cohort_id as cohort_definition_id, person_id, start_date, end_date 
FROM #final_cohort CO
;






TRUNCATE TABLE #cohort_rows;
DROP TABLE #cohort_rows;

TRUNCATE TABLE #final_cohort;
DROP TABLE #final_cohort;

TRUNCATE TABLE #inclusion_events;
DROP TABLE #inclusion_events;

TRUNCATE TABLE #qualified_events;
DROP TABLE #qualified_events;

TRUNCATE TABLE #included_events;
DROP TABLE #included_events;

TRUNCATE TABLE #Codesets;
DROP TABLE #Codesets;